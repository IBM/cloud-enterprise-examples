{"version":3,"sources":["webpack:///./src/pages/iac-resources/iam/index.mdx"],"names":["_frontmatter","makeShortcode","name","props","console","warn","PageDescription","AnchorLinks","AnchorLink","InlineNotification","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","small","isMDXComponent"],"mappings":"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","file":"component---src-pages-iac-resources-iam-index-mdx-74eee7f998f98c1fc233.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/johandry/Workspace/ibm/att-cloudnative/ibmcloud-pattern-guide/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst AnchorLinks = makeShortcode(\"AnchorLinks\");\nconst AnchorLink = makeShortcode(\"AnchorLink\");\nconst InlineNotification = makeShortcode(\"InlineNotification\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    {\n      /*\n      The pattern to document the resources is like follow:\n      - Introduce the resource with an example\n      - List all or the most important input parameters\n      - If will be used, list the most important output parameters\n      - Provide instructions to get the value of the input parameters, either using `ibmcloud`, API or the Web console.\n      - If needed, instructions to execute the code either with Terraform or Schematics\n      */\n    }\n    <PageDescription mdxType=\"PageDescription\">\n      <p>{`Automating Identity and Access Management`}</p>\n    </PageDescription>\n    <p>{`Identify and Access Management (IAM) is central to IBM Cloud access and resource controls.  Basic information about IAM and different components can be found `}<a parentName=\"p\" {...{\n        \"href\": \"https://cloud.ibm.com/docs/iam?topic=iam-iamoverview\"\n      }}>{`in the IAM overview`}</a></p>\n    <p>{`In this example, we will look at a terraform script which creates 4 Access Groups, and then creates 2 policies for each of these 4 Access Groups.  In order to use these scripts, you must have proper administrator access.`}</p>\n    <AnchorLinks small mdxType=\"AnchorLinks\">\n  <AnchorLink mdxType=\"AnchorLink\">IAM</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Resource Groups</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Final Terraform code</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Clean up</AnchorLink>\n    </AnchorLinks>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p><strong parentName=\"p\">{`Requirements`}</strong></p>\n      <p>{`To be able to execute and complete the instructions in this page, make sure you have an `}<strong parentName=\"p\">{`IBM Cloud account`}</strong>{`: if you don’t have one yet, you can `}<a parentName=\"p\" {...{\n          \"href\": \"https://cloud.ibm.com/docs/overview?topic=overview-quickstart_lite#prereqs-lite\"\n        }}>{`create a Lite account`}</a>{` for free.`}</p>\n      <p>{`Also make sure you have the environment setup as explained in the `}<a parentName=\"p\" {...{\n          \"href\": \"/cloud-enterprise-examples/iac/setup-environment\"\n        }}>{`Setup Environment`}</a>{` page to have installed the IBM Cloud CLI, logged in to your account with the IBM Cloud CLI and set the `}<inlineCode parentName=\"p\">{`IC_API_KEY`}</inlineCode>{` environment variable to a key which has the ability to manage IAM configuration.`}</p>\n    </InlineNotification>\n    <h2>{`IAM`}</h2>\n    <p>{`Two of the main components of IAM are:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Access Groups — contains users & services, whose access can be managed as a group.`}</li>\n      <li parentName=\"ul\">{`Policies — Policies for an access group define what access this group has to various resources.  Multiple policies can be set up for each access group, specifying various resources. Policies define role-based access at the platform and service level. There are a standard set of platform and service roles and some IBM Cloud services have special roles as documented in the individual service documentation.`}</li>\n    </ul>\n    <p>{`Before you run through this example, make sure your Terraform environment is setup correctly as documented in the `}<a parentName=\"p\" {...{\n        \"href\": \"/cloud-enterprise-examples/iac/setup-environment\"\n      }}>{`environment setup`}</a>{`.  Specifically make sure you get a list of access groups as documented in the setup document.`}</p>\n    <p>{`To get started, in your IBM Cloud CLI, run the following command and make a list of all the access groups you have in your cloud account.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`ibmcloud iam access-groups\n`}</code></pre>\n    <p>{`The example will create 4 new access groups: access-group-1, access-group-2, access-group-3, access-group-4\nThe Terraform code will then add different policies to each of the access groups. For the first two access groups, the permissions for a Kubernetes cluster administrator and an application auditor will be assigned based on the `}<a parentName=\"p\" {...{\n        \"href\": \"https://cloud.ibm.com/docs/openshift?topic=openshift-users#example-iam\"\n      }}>{`service example use cases`}</a>{`. For the third access group, administrative access will be created for the Schematics service. For the fourth access group, administrative access will be created for the Cloud Object Storage service. For granularity, each access group collection of policies is in a single file.`}</p>\n    <p>{`Let’s look at some of the code.`}</p>\n    <p>{`Code to define the names for the Access Groups.  Set the variables ‘ag1’ ‘ag2’ ‘ag3’ ‘ag4’ to the names of the Access Groups we are creating.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=accessgroup.tf\",\n        \"path\": \"accessgroup.tf\"\n      }}>{`variable ag1{\n    type = string\n    default = \"access-group-1\"\n}\n\nvariable ag2{\n    type = string\n    default = \"access-group-2\"\n}\n\nvariable ag3{\n    type = string\n    default = \"access-group-3\"\n}\n\nvariable ag4{\n    type = string\n    default = \"access-group-4\"\n}\n`}</code></pre>\n    <p>{`Let’s look at the policies for `}<inlineCode parentName=\"p\">{`access-group-1`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\",\n        \"metastring\": \"path=policy-accessgroup-1.tf\",\n        \"path\": \"policy-accessgroup-1.tf\"\n      }}>{`resource \"ibm_iam_access_group\" \"res_ag_1\" {\n   name  = var.ag1\n   description = \"Access group for Kubernetes cluster administrators\"\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag_policy1\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_1.id\n  roles        = [\"Administrator\", \"Manager\"]\n  resources  {\n    service   = \"containers-kubernetes\"\n\n  }\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag_policy2\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_1.id\n  roles        = [\"Administrator\", \"Manager\"]\n  resources  {\n    service   = \"container-registry\"\n\n  }\n}\n`}</code></pre>\n    <p>{`The above script is setting ‘access-group-1’ with ‘Administrator’ platform & ‘Manager’ service role to the ‘containers-kubernetes’ service, and the same for ‘container-registry’.`}</p>\n    <p>{`Users can be added to access groups by their IBMid (email-address). The example code will add a user in the account to access groups 1, 3, and 4. You can list all of the e-mail addresses in the account using:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`ibmcloud iam users\n`}</code></pre>\n    <p>{`Select one of the user email addresses to provide when prompted by the terrraform cli.`}</p>\n    <p>{`You can download the full example code from the GitHub repository `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/IBM/cloud-enterprise-examples/\"\n      }}>{`https://github.com/IBM/cloud-enterprise-examples/`}</a>{` in the directory `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/IBM/cloud-enterprise-examples/tree/master/iac/05-iam\"\n      }}>{`05-iam`}</a>{`, and then run the following commands in IBM Cloud CLI to create the access groups and policies`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`terraform init\nterraform apply\n`}</code></pre>\n    <p>{`The script will ask you to validate the creation, and upon successful execution, you should see 12 items added by the script.`}</p>\n    <p>{`Now re-execute the following command to see the newly created access groups`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`ibmcloud iam access-groups\n`}</code></pre>\n    <h2>{`Resource Groups`}</h2>\n    <p>{`Resource Groups, as the name state, is a collection of cloud resources within an account. With all the resources in a group is easier and quick to assign user access to the resources using IAM access controls.`}</p>\n    <p>{`To manage the Resource Groups with the IBM Cloud web console go to `}<strong parentName=\"p\">{`Manage`}</strong>{` > `}<strong parentName=\"p\">{`Account`}</strong>{` > `}<strong parentName=\"p\">{`Account resources`}</strong>{` > `}<strong parentName=\"p\">{`Resource groups`}</strong>{`. There you can create, view and modify them adding resources and manage the access to them. To delete a Resource Group it has to be empty.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"916px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"36.45833333333333%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABYlAAAWJQFJUiTwAAABeUlEQVQY0yWO70rCUBiHvQDBC3DD0XA7YlOw/SnMdAQVQkXOBOv7PjXQklBW+xDoRXgZXoAXoQlCRmvhhuEWuURJxN6t58t5z++c33lOIJ1OZ7PZYrFYkCSEkCzLm81GURQcxzmOI8mtSCRCkmQmkxFFMZfLiT4sy5bL5UC322232xzPCTwfDAahBuVKpYJhWNQHw8L5fF7X9dHL6NVjBBiGYZpmAK7qb3qpVJIkSRAETdNs24YyQjGGScTjcYIg4MhxbMN4t0zzAxbDcF13uVwG1uv182CQ92EYRlVVSBXlBtFRlt2JxRCOhc/PTn984F3H+XJsezqdfk4mnrnf7yeTCdCC5OFRg6SuPu1lTg6PC6ldkdrmL6/l75m7WCxWq9WvDwyeGa72ej0qStE0HQqF7mr3kNzW6omUcCAescI+QaKL4tW/djgcjsdj08eyLK8MU6vVajabjUaj0+lAUq1WaJpCNEVRURzH4NvubDafzx3HAf/SB7Z/CrPnNBNSJlQAAAAASUVORK5CYII=')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"Resource Groups\",\n        \"title\": \"Resource Groups\",\n        \"src\": \"/cloud-enterprise-examples/static/e9a5fcc74904690d207f725370b45db2/afc4b/resource-group.png\",\n        \"srcSet\": [\"/cloud-enterprise-examples/static/e9a5fcc74904690d207f725370b45db2/7fc1e/resource-group.png 288w\", \"/cloud-enterprise-examples/static/e9a5fcc74904690d207f725370b45db2/a5df1/resource-group.png 576w\", \"/cloud-enterprise-examples/static/e9a5fcc74904690d207f725370b45db2/afc4b/resource-group.png 916w\"],\n        \"sizes\": \"(max-width: 916px) 100vw, 916px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`Use the IBM Cloud CLI command with the `}<inlineCode parentName=\"p\">{`resources`}</inlineCode>{` sub-command to manage the resources groups, like so`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`# List resource groups:\nibmcloud resource groups\n# Create:\nibmcloud resource group-create group2\n# Rename:\nibmcloud resource group-update group2 --name Admin\n# View resources:\nibmcloud resource service-instances -g Default\n# Delete:\nibmcloud resource group-delete Admin\n`}</code></pre>\n    <p>{`To assign an access to a resource group using the IBM Cloud CLI use the command using the resource group name or id.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`ibmcloud iam user-policy-update USER_NAME POLICY_ID --resource-group-name RESOURCE_GROUP_NAME\nibmcloud iam user-policy-update USER_NAME POLICY_ID --resource-group-id RESOURCE_GROUP_ID\n`}</code></pre>\n    <p>{`Resource Groups are not part of Networking but as it’s one of the first resources to create it’s included in this pattern.`}</p>\n    <p>{`Create a Resource Group using the `}<inlineCode parentName=\"p\">{`ibm_resource_group`}</inlineCode>{` resource with the following code in the `}<inlineCode parentName=\"p\">{`main.tf`}</inlineCode>{` file.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=main.tf\",\n        \"path\": \"main.tf\"\n      }}>{`data \"ibm_resource_group\" \"iac_app_rg\" {\n  name = var.resource_group_name\n}\n`}</code></pre>\n    <p>{`If the `}<inlineCode parentName=\"p\">{`name`}</inlineCode>{` parameter, or in this example the variable `}<inlineCode parentName=\"p\">{`resource_group_name`}</inlineCode>{` value, cannot be empty, it’s a a required parameter. So make sure to have at least a default value in the variables.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=variables.tf\",\n        \"path\": \"variables.tf\"\n      }}>{`variable \"resource_group_name\" {\n  description = \"The resource group for all the resources created\"\n  default     = \"IaC-App\"\n}\n`}</code></pre>\n    <h2>{`Final Terraform code`}</h2>\n    <p>{`You can download the code from the GitHub repository `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/IBM/cloud-enterprise-examples/\"\n      }}>{`https://github.com/IBM/cloud-enterprise-examples/`}</a>{` in the directory `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/IBM/cloud-enterprise-examples/tree/master/iac/07-compute\"\n      }}>{`07-compute`}</a>{` where the main files are:`}</p>\n    <p>{`First, main.tf which simply specifies the provider, region & the resource group we want to use, which is “Default”  Replace this with the resource group you have in your environment.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=main.tf\",\n        \"path\": \"main.tf\"\n      }}>{`provider \"ibm\" {\n  generation = 2\n  region     = \"us-south\"\n}\n\ndata \"ibm_resource_group\" \"group\" {\n  name = \"Default\"\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=accessgroup.tf\",\n        \"path\": \"accessgroup.tf\"\n      }}>{`variable ag1 {\n    type = string\n    default = \"access-group-1\"\n}\n\nvariable ag2 {\n    type = string\n    default = \"access-group-2\"\n}\n\nvariable ag3 {\n    type = string\n    default = \"access-group-3\"\n}\n\nvariable ag4 {\n    type = string\n    default = \"access-group-4\"\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=policy-access-group-1.tf\",\n        \"path\": \"policy-access-group-1.tf\"\n      }}>{`resource \"ibm_iam_access_group\" \"res_ag_1\" {\n   name  = var.ag1\n   description = \"Access group for Kubernetes cluster administrators\"\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag_policy1\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_1.id\n  roles        = [\"Administrator\", \"Manager\"]\n  resources  {\n    service   = \"containers-kubernetes\"\n\n  }\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag_policy2\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_1.id\n  roles        = [\"Administrator\", \"Manager\"]\n  resources  {\n    service   = \"container-registry\"\n\n  }\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=policy-access-group-2.tf\",\n        \"path\": \"policy-access-group-2.tf\"\n      }}>{`resource \"ibm_iam_access_group\" \"res_ag_2\" {\n    name  = var.ag2\n    description = \"Access group for Kubernetes cluster auditors\"\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag2_policy1\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_2.id\n  roles        = [\"Viewer\", \"Reader\"]\n  resources  {\n    service   = \"containers-kubernetes\"\n\n  }\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag2_policy2\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_2.id\n  roles        = [\"Reader\"]\n  resources  {\n    service   = \"container-registry\"\n\n  }\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=policy-access-group-3.tf\",\n        \"path\": \"policy-access-group-3.tf\"\n      }}>{` resource \"ibm_iam_access_group\" \"res_ag_3\" {\n  name  = var.ag3\n  description = \"Access group for Schematics workspace managers\"\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag3_policy1\" {\n\n  access_group_id = ibm_iam_access_group.res_ag_3.id\n  roles        = [\"Administrator\", \"Manager\"]\n  resources  {\n    service   = \"schematics\"\n\n  }\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=policy-access-group-4.tf\",\n        \"path\": \"policy-access-group-4.tf\"\n      }}>{`resource \"ibm_iam_access_group\" \"res_ag_4\" {\n    name  = var.ag4\n    description = \"Access group for Cloud Object Storage administrators\"\n}\n\nresource \"ibm_iam_access_group_policy\" \"res_ag4_policy1\" {\n  access_group_id = ibm_iam_access_group.res_ag_4.id\n  roles        = [\"Administrator\", \"Manager\"]\n  resources {\n    service = \"cloud-object-storage\"\n  }\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=user.tf\",\n        \"path\": \"user.tf\"\n      }}>{`variable \"user_email\" {}\n\nresource \"ibm_iam_access_group_members\" \"ag1_members\" {\n  access_group_id = ibm_iam_access_group.res_ag_1.id\n  ibm_ids         = [ var.user_email ]\n}\n\nresource \"ibm_iam_access_group_members\" \"ag3_members\" {\n  access_group_id = ibm_iam_access_group.res_ag_3.id\n  ibm_ids         = [ var.user_email ]\n}\n\nresource \"ibm_iam_access_group_members\" \"ag4_members\" {\n  access_group_id = ibm_iam_access_group.res_ag_4.id\n  ibm_ids         = [ var.user_email ]\n}\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-hcl\",\n        \"metastring\": \"path=output.tf\",\n        \"path\": \"output.tf\"\n      }}>{`output \"accessGroup1\" {\n    value = ibm_iam_access_group.res_ag_1\n}\n\noutput \"accessGroup2\" {\n    value = ibm_iam_access_group.res_ag_2\n}\n\noutput \"accessGroup3\" {\n    value = ibm_iam_access_group.res_ag_3\n}\n\noutput \"accessGroup4\" {\n    value = ibm_iam_access_group.res_ag_4\n}\n`}</code></pre>\n    <h2>{`Clean up`}</h2>\n    <p>{`To cleanup all the resources created by the script, run the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`terraform destroy\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}