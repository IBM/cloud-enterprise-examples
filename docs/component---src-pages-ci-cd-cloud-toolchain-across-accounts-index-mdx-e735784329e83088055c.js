(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{uOqu:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return g}));a("91GP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("q1tI");var i=a("7ljp"),n=a("013z");a("qKvR");function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}var o={},l=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(i.b)("div",t)}},r=l("PageDescription"),s=l("AnchorLinks"),p=l("AnchorLink"),b=l("InlineNotification"),d={_frontmatter:o},u=n.a;function g(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,i,n={},c=Object.keys(e);for(i=0;i<c.length;i++)a=c[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,["components"]);return Object(i.b)(u,c({},d,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)(r,{mdxType:"PageDescription"},Object(i.b)("p",null,"Cross Account Pipelines with IBM Cloud Toolchain")),Object(i.b)(s,{small:!0,mdxType:"AnchorLinks"},Object(i.b)(p,{mdxType:"AnchorLink"},"Overview"),Object(i.b)(p,{mdxType:"AnchorLink"},"Setting up access to production kubernetes cluster")),Object(i.b)("h2",null,"Overview"),Object(i.b)("p",null,"The toolchain brings together many resources. A git repo, the Docker Registry, a Kubernetes Cluster and the toolchain itself."),Object(i.b)("p",null,"Everything created in the environment setup so far was done using a single IAM role, in a single resource group, in a single IBM Cloud Account. "),Object(i.b)("p",null,Object(i.b)("span",c({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"511px"}}),"\n      ",Object(i.b)("span",c({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"74.30555555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACXElEQVQ4y3VUa2+bQBDk//+cVkla1cmHKs82yqNN7DzUOAm2MdgxrzsO7oDp7lKIHKmHVrfi7uZmZwe8oiiQpilms5lEEAQS/E5rDaUU8jyX4JxDK41CF7TeBecq79Y83shjs4kpNhJhGMI5h/+NunUoagXTFDA1ATot76218LI8w0pH0EYLi7Ish4Nt26Kua2RZJoyZgbMOj8E9ju4PcfpwguO7I5w+nkBbhdKUBJilWBNgnGyk1Le3twFM2BBgFEXwfR9JksihiX+Lg18jHFzt4+B6H4eT78SSGBcGHt/6cfRg/dyXM+RNRSVrpEWCrEyFXUsP92MA5MN9bIHSY21F5eaSy/t/97jKoXb1cBE30eMyuAlN02wB88jLDJPgFnfBhOYxxpRHeThIEcex6N60zTsgi82g2yy7DYnZYO98B7tnO/h6/gWfTz5hun6StaqqxGasb09GALkRi8VC6m/RbmmpTA4/fsE89fG6ecaM5sTEwzpbi5lulczdmz5PxZwiOOmyCldYR2vkWedREIGyeLdTX2JKDtGFQi+qAMZJTHZZIowDLFWAafgHTxTz2EdpTXeJs7K5r2CZLfB7do3L6YXEOLgRg4tt+BZm8xje4+frD9HqmEx7tbhEZjptXe1gjBkY+ukLRtcjjC6+Ye9sF8cPR1A23/bhPJlhvLzB7fym62w4hq7U4EFuHM8cqzQSTe/8CabRE4JsTt600iiPP6teF1db1I2Do0XOe/vwRm4cd5RtYis6XFbCqG3eG8lVeHwjb2KNPsbwd6GcXdDPkhddrrQa/kgM+BeBZXz5RrSCvgAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(i.b)("img",c({parentName:"span"},{className:"gatsby-resp-image-image",alt:"CICD All Access",title:"CICD All Access",src:"/att-cloudnative/ibmcloud-pattern-guide/static/0d97cacc79f258812d86401522aabacc/c8e99/cicd-toolchain-allaccess.png",srcSet:["/att-cloudnative/ibmcloud-pattern-guide/static/0d97cacc79f258812d86401522aabacc/7fc1e/cicd-toolchain-allaccess.png 288w","/att-cloudnative/ibmcloud-pattern-guide/static/0d97cacc79f258812d86401522aabacc/c8e99/cicd-toolchain-allaccess.png 511w"],sizes:"(max-width: 511px) 100vw, 511px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),"    "),Object(i.b)("p",null,"A powerful way to organize access is to put different IBM Cloud Resources into different ",Object(i.b)("strong",{parentName:"p"},"Resource Groups"),".  "),Object(i.b)("p",null,Object(i.b)("span",c({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"511px"}}),"\n      ",Object(i.b)("span",c({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"74.30555555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACeUlEQVQ4y3VUaW/TQBD1//8pCNQKKEWoKvCFUJXS9KDkcGqc+I7dxOv1fTxmtrETEKw0mrU9M/vem1lrWZYhjmPYtg3LsuC6rrLtdgsppbIkSZT1zzJNISnv0JLdN40DeUVRpGyz2SAMQ3Rdh/+uqgISAapAlqDjPcVX9F4T9BDmIZq2Rp7lSOn0PM8hhEBZlmjbVu2ZBSMomwbbh3v452fwP3+E++kcAflOxMgpXovjLVxrQsEChmFgPp8rv1gsFG1G6vs+VqsVtoQ+K0qEN2OY797i8fQEBpl79kEhTouCKNPJDRWo0gwhUQ6CQFFnz4j2LKth31EiF6ieItSbJ4WOqID7oR0m/WsxwoqoSNK6oyR+7tUt6xoVvesXy6VxE3zPU1qpYLZdUE1yyPE15O0YyQ358XeUjq2+taQl5ya7g4aCLDZr1aPpTRUM19CPXmFCpr8+xvTlC8jZ5BkdoeYxY2naw4L93DH/Pc3ngJK6WyzmqIxHZPoctbFAHYUD5Zoo14T0D8qmaULXdTUyvKSQWAchojCCSKRK5pSUEA0H7hAJkiTjHuwYqYKO7cBxHQSJB084mNlTLCMTfuwNVGrqMAdj15BitUR8eYHwYoTw6wjy+gpdKmmkaGyESGA5Fq6tK4zmX/D+8hTfzEvM1tOBekO0eNiHEVroWJ68wSPN4uT4CGsa8o7QqjlMaf7qpsIsmOCn94B7+478D5hPxlCQZ5Abx55HJfVcpen67hZiNkW1/IWOJCn4pvC1Uijo6tVthaar1QFNuxebO+o4juooj0lBhXOWgRA1B3e+IBYan8pBrNHf1v9deM9T0PuMff+u/wNRDZblNzpqecRw8Kh3AAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(i.b)("img",c({parentName:"span"},{className:"gatsby-resp-image-image",alt:"CICD Namespaces",title:"CICD Namespaces",src:"/att-cloudnative/ibmcloud-pattern-guide/static/b6f33f86e988753f0c41539a86d53b79/c8e99/cicd-toolchain-rgs.png",srcSet:["/att-cloudnative/ibmcloud-pattern-guide/static/b6f33f86e988753f0c41539a86d53b79/7fc1e/cicd-toolchain-rgs.png 288w","/att-cloudnative/ibmcloud-pattern-guide/static/b6f33f86e988753f0c41539a86d53b79/c8e99/cicd-toolchain-rgs.png 511w"],sizes:"(max-width: 511px) 100vw, 511px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),"       "),Object(i.b)("p",null,"For admin level or a higher level of isolation, it is common to put a production cluster in a different IBM Cloud Account from all other environments."),Object(i.b)("p",null,Object(i.b)("span",c({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"691px"}}),"\n      ",Object(i.b)("span",c({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"76.7361111111111%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACCklEQVQ4y5VUXW/bMAzM//9R24q1WNoNe+i2IliXLXHjOHb8bcmSLNk3Uq6MtC/rDiDISCR1OspZSSmhlELf94s/nU5IkgR1Xfs1YwytSxitFtNkXdf5nKZpfMy5qzm590UBaZoiiiIMw4BxHNG1LcYJkJTSD4Ag738TmaIokOe5b2atxUprjbIs0VIRY5omXIITi/yMrOrx8f6E6/sjrr+lSIoedjAYqEkAE1jxKcyIqYeGwRi8XlUllHGIC42nTOKQK0hlib2DoHq+xdJQCOGDGS/ZMbIs8zdgWKOQpQlGNyz7l1L5hiwmF/HVo3KPh/gHNskDDtUTFZJ+dGDbNrBuQistTnkDodwsB2kfx7HXcmnIGjnnIGmKP9MNbh/X+PLnM35lj/4QHpjoWmSNxc33FFdfI9xtcpSNZH1ousLXLw25IGCcHEY4uIn0mWZdeHIdNWx7i0NhSD+NY2mI+VzHhwZw7KfMLNk41krP/nmdPYuuKR54qoZNo64qv89DC7me4cvJjp4Z2+WkGV4WOT9+IaR/zEobVDX7WRo+bPX63b1G2A9aM/hltNRwIkaSGI5mvvbxeJwb/stCwxALYpNHe5w/vENy9R4peaKP37vdfOW3MgyxI2+IYX63RvzpBufbNU1EYbeP/q/hJTTpZegF2OevhLHdbt/eMEySp8rGOgZJwqfH/1J/AVBTjXlnBtIsAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(i.b)("img",c({parentName:"span"},{className:"gatsby-resp-image-image",alt:"CICD Namespaces",title:"CICD Namespaces",src:"/att-cloudnative/ibmcloud-pattern-guide/static/87e4a27a3f4557babebb54bc93575438/71afd/cicd-toolchain-accounts.png",srcSet:["/att-cloudnative/ibmcloud-pattern-guide/static/87e4a27a3f4557babebb54bc93575438/7fc1e/cicd-toolchain-accounts.png 288w","/att-cloudnative/ibmcloud-pattern-guide/static/87e4a27a3f4557babebb54bc93575438/a5df1/cicd-toolchain-accounts.png 576w","/att-cloudnative/ibmcloud-pattern-guide/static/87e4a27a3f4557babebb54bc93575438/71afd/cicd-toolchain-accounts.png 691w"],sizes:"(max-width: 691px) 100vw, 691px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),"    "),Object(i.b)("h2",null,"Setting up access to production kubernetes cluster"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Login into a second IBM Cloud Account, this will be “Production”.\nYou will need to configure and create a k8s cluster by following ",Object(i.b)("a",c({parentName:"li"},{href:"../deploy-iks/setup-environment"}),"these instructions"),".\nAs a quick reference you can run the following command to create a cluster on VPC Gen 2.")),Object(i.b)("pre",null,Object(i.b)("code",c({parentName:"pre"},{className:"language-bash"}),"$ ibmcloud ks cluster create vpc-gen2 --flavor FLAVOR --name NAME --subnet-id ID --vpc-id ID --zone ZONE\n")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Create an API Key to access your cluster")),Object(i.b)("pre",null,Object(i.b)("code",c({parentName:"pre"},{className:"language-bash"}),"$ ibmcloud iam api-key-create kubernetes-key\nCreating API key kubernetes-key under e65910fa61ce9072d64902d03f3d4774 as John.Zaccone@ibm.com...\nOK\nAPI key kubernetes-key was created\n\nPlease preserve the API key! It cannot be retrieved after it's created.\n                 \nID            ApiKey-0159e477-07d7-409d-ac84-c366528b6c65   \nName          kubernetes-key   \nDescription      \nCreated At    2020-05-12T17:44+0000   \nAPI Key       XXXXXXXXXXXX   \nLocked        false\n")),Object(i.b)(b,{mdxType:"InlineNotification"},"This will create a new API key that allows anyone who has it the ability to do anything you could do. To make things more secure, you will want to create a service ID API key that limits access to only what your pipeline requires. The following steps apply for any API key you create that has access to the Kubernetes cluster that you want to deploy to."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Log into the first account. This will be our “Tools” environment, where our pipeline lives, and where we will use the key to our Kubernetes cluster.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Find the ",Object(i.b)("strong",{parentName:"p"},"DevOps")," page from the upper-left handside menu. Open the Toolchain you created earlier")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Next to the ",Object(i.b)("strong",{parentName:"p"},"Deploy"),", click the ",Object(i.b)("strong",{parentName:"p"},"Configure")," icon"))),Object(i.b)("p",null,Object(i.b)("span",c({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"882px"}}),"\n      ",Object(i.b)("span",c({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"51.388888888888886%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB5klEQVQoz22SyW7UQBCG/W4ckECcuIcDr4CQEHDIESTuPAMPgBJyCBCBCEsyiNEAcWaxxzMet/fd3V5+qno0EYiU9Km6uu3qv6rLKIoSddOgqrfwumkk+X/hvUYq1HUNKSXKskSWZf9h9J3CdD6DZVtYOg66VuJ6GyBCH77wYJomlFIoikInZlgYx8bPhY/TiYsvvzYYmQI/ZgHGiwjjeYjRZYDzS1/7swuBd6MFLmZL2NYCQvjwPA8bgr0QAkEQwHjw8gNuPHyNO08Pce/5W+w9OyZ/jPsv3uPu/hFuPT7A7SeHdP4GNx8d4NXRCJPJGCcfT/H56xn5T/h2/h2Os8RqtYKR5hWitEQQ59qXTYuybrHxEyLG2guxdH1YK0/7NMsRhpFG+AHiONElc2/TNIWh1LbhVcXNVhiGQZNTT+IkRUEfJ2mm1+xV2yKkJBw76w1yOt8ZJzW6rsN8Sf2bmJjaa8wIc+Fgaq21ot8zG/ZaaNV5pVDSxQ39WFWVTpDnGVq6hI33DB6BRlKZFY+NvGIXF5yAKmjbDpJetqGxSpIEURTpEvkxeI+NSzc4YJVc5rXDQtuNonIY2etZzP+aO1a1M62QE6Z0sOtf3/dXDIRUPUTaw0u2JBk9oO9rZa7ranj+GFb+Bxwt7BtXUmFFAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(i.b)("img",c({parentName:"span"},{className:"gatsby-resp-image-image",alt:"Configure Deploy Stage",title:"Configure Deploy Stage",src:"/att-cloudnative/ibmcloud-pattern-guide/static/6c79a8149b9fceef2a5edb014e13b25c/e0956/cicd-pipeline-configuredeploy.png",srcSet:["/att-cloudnative/ibmcloud-pattern-guide/static/6c79a8149b9fceef2a5edb014e13b25c/7fc1e/cicd-pipeline-configuredeploy.png 288w","/att-cloudnative/ibmcloud-pattern-guide/static/6c79a8149b9fceef2a5edb014e13b25c/a5df1/cicd-pipeline-configuredeploy.png 576w","/att-cloudnative/ibmcloud-pattern-guide/static/6c79a8149b9fceef2a5edb014e13b25c/e0956/cicd-pipeline-configuredeploy.png 882w"],sizes:"(max-width: 882px) 100vw, 882px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),"    "),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Change the ",Object(i.b)("strong",{parentName:"li"},"API Key")," to the value you generated for your production cluster")),Object(i.b)("p",null,Object(i.b)("span",c({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(i.b)("span",c({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"75.69444444444444%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABXUlEQVQ4y52TWU6EQBiE55AmRp998jRGH028gInnMB5jWMIS9manu+xqBMVZYIakWBr66+q/fnbDMCBKEqRZjrwokKQZwihGludQSh1VPygACh9fEvcvEndaj28SiVDYEbi3Xdiuh73jwvF8DSsgyvIkcPgBvn8q3D5L3DxJPLwqpCVGYBzHSNMUTdNg66HU/5FOj0nsuGIYhrAsC1mWoa5rCCGMSu3ynIQYVRQCud6VlBrIE91RE7Dv+1ld16Ft21VVVfULpEPHcYyCIJgXSHRYdMoJLMc5LYCcyDoWTFnfR1FknnnNddp0zQnHNL1jCRYOCeMLurl0y/zmYMu2bcN1XQNeC+OUDJBtQyBrRxgH/zrcIjJmh2wbBuD7vgmA0GtFlnE4hcJ6jE07/hFccYv4LZOeHdIdG5s1nNrH87y5wde0cEgq24N1ZItMyVJX1ZAPdEhHh7+WuMgl4d9GzYalvGKL+QAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(i.b)("img",c({parentName:"span"},{className:"gatsby-resp-image-image",alt:"Configure Deploy Stage",title:"Configure Deploy Stage",src:"/att-cloudnative/ibmcloud-pattern-guide/static/50d0bc5a6884374d17ed3242acab0e6a/3cbba/cicd-pipeline-apikey.png",srcSet:["/att-cloudnative/ibmcloud-pattern-guide/static/50d0bc5a6884374d17ed3242acab0e6a/7fc1e/cicd-pipeline-apikey.png 288w","/att-cloudnative/ibmcloud-pattern-guide/static/50d0bc5a6884374d17ed3242acab0e6a/a5df1/cicd-pipeline-apikey.png 576w","/att-cloudnative/ibmcloud-pattern-guide/static/50d0bc5a6884374d17ed3242acab0e6a/3cbba/cicd-pipeline-apikey.png 1152w","/att-cloudnative/ibmcloud-pattern-guide/static/50d0bc5a6884374d17ed3242acab0e6a/b11f7/cicd-pipeline-apikey.png 1496w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),"    "),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Save the values and rerun the Deploy stage to see the app deployed to your production cluster in your other account.")))}g.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-ci-cd-cloud-toolchain-across-accounts-index-mdx-e735784329e83088055c.js.map