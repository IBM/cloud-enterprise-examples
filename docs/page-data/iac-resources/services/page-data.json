{"componentChunkName":"component---src-pages-iac-resources-services-index-mdx","path":"/iac-resources/services/","result":{"pageContext":{"frontmatter":{"title":"IaC to Cloud Services","description":"Use IaC to work with managed Databases services","keywords":"terraform,ibm cloud,db,dba"},"relativePagePath":"/iac-resources/services/index.mdx","titleType":"page","MdxNode":{"id":"c1315d68-e14c-53a8-a673-5cf2c8e9ca53","children":[],"parent":"b99a396f-8bc4-5bd3-962b-025fafdb0a53","internal":{"content":"---\ntitle: IaC to Cloud Services\ndescription: Use IaC to work with managed Databases services\nkeywords: 'terraform,ibm cloud,db,dba'\n---\n\n<!--\n\nThe pattern to document the resources is like follow:\n- Introduce the resource with an example\n- List all or the most important input parameters\n- If will be used, list the most important output parameters\n- Provide instructions to get the value of the input parameters, either using `ibmcloud`, API or the Web console.\n- If needed, instructions to execute the code either with Terraform or Schematics\n\n-->\n\n<PageDescription>\n\nUse of IaC to work with Cloud Services such as Managed Databases and  MQ (Message Queue)\n\n</PageDescription>\n\nThis page contains example scripts for some of the following services.  You can directly navigate to the resource you are interested in using the links.\n\nAs you look at the PostgreSQL & MongoDB scripts, you will notice the similarity.  In fact, except for the 'serviceID', they are identical.  This is because the scripts are using Resource Management Resources.  You can find out more about it [here](https://cloud.ibm.com/docs/terraform?topic=terraform-resource-mgmt-resources#resource-instance).  \n\n<AnchorLinks small>\n  <AnchorLink>PostgreSQL</AnchorLink>\n  <AnchorLink>MongoDB</AnchorLink>\n  <AnchorLink>MQ</AnchorLink>\n  <AnchorLink>Demo & Cleanup</AnchorLink>\n</AnchorLinks>\n\nIBM Cloud Database offers many database options, each one being useful in a particular use-case.  You can refer to this [documentation](https://www.ibm.com/cloud/databases) for more information on IBM Cloud Databases.  \n\n### PostgreSQL\n\nFollowing script will create an instance of the PostgreSQL in the resource group you specify.  \n\n```hcl path=postgreSQL.tf\n// main.tf\n#*****************************************************************************\n# IBM Terraform Provider Documentation Block References\n#   IBM Provider:    https://cloud.ibm.com/docs/terraform?topic=terraform-provider-reference&-access-data-sources\n#   Resource Group:  https://cloud.ibm.com/docs/terraform?topic=terraform-resource-management-data-sources&-access-data-sources#resource-group\n#\n#   Database :       https://cloud.ibm.com/docs/terraform?topic=terraform-databases-resources#db\n#   Access Group:    https://cloud.ibm.com/docs/terraform?topic=terraform-iam-resources&-access-data-sources#iam-access-group-policy\n#*****************************************************************************\n\n##############################################################################\n# IBM Cloud Provider\n##############################################################################\n\nprovider \"ibm\" {\n  region             = \"${var.ibm_region}\"\n  generation         = 2\n  ibmcloud_timeout   = 60\n}\n\n##############################################################################\n\n\n\n##############################################################################\n# Resource group ID from name\n##############################################################################\ndata \"ibm_resource_group\" \"group\" {\n  name = \"${var.resource_group_name}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Provision database instance\n##############################################################################\nresource \"ibm_database\" \"db_instance\" {\n  name              = \"${var.db_name}\"\n  plan              = \"${var.plan}\"\n  location          = \"${var.ibm_region}\"\n  service           = \"databases-for-postgresql\"\n  resource_group_id = \"${data.ibm_resource_group.group.id}\"\n\n  adminpassword                = \"${var.db_admin_password}\"\n  members_memory_allocation_mb = \"${var.db_memory_allocation}\"\n  members_disk_allocation_mb   = \"${var.db_disk_allocation}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Grant User Access to Database\n# For simplification, this block is not used. You can assign access policies at the\n# account, resource group, service, instance using this type of block.\n##############################################################################\n# resource \"ibm_iam_access_group_policy\" \"ex2_db_policy\" {\n#  access_group_id = ibm_iam_access_group.labuser.id\n#  roles        = [\"Reader\"]\n\n#  resources = [{\n#    service = \"databases-for-postgresql\"\n#    resource_instance_id = element(split(\":\", ibm_database.db_instance.id),7)\n#  }\n#  ]\n# }\n##############################################################################\n\n// outputs.tf\n\noutput \"db_crn_id\" {\n  value = \"${ibm_database.db_instance.id}\"\n}\n/*\noutput \"db_connection_string\" {\n  value = \"http://${ibm_database.db_instance.connectionstrings.0.name}\"\n} */\n\noutput \"db_admin_userid\" {\n  value = \"${ibm_database.db_instance.adminuser}\"\n}\noutput \"db_version\" {\n  value = \"${ibm_database.db_instance.version}\"\n}\n\n// variables.tf\n\n\n\nvariable \"plan\" {\n  default = \"standard\"\n  description = \"Cloud Database Plan\"\n}\nvariable \"ibm_region\" {\n  default = \"us-south\"\n  description = \"Cloud Database region \"\n}\nvariable \"db_name\" {\n  default = \"ex2_test_db_lab\"\n  description = \"Database name\"\n}\nvariable \"resource_group_name\" {\n  description = \"IBM Cloud Resource Group Name\"\n}\nvariable \"db_admin_password\" {\n  default = \"password123\"\n  description = \"Database administration password\"\n}\n\nvariable \"db_memory_allocation\" {\n  default = \"3072\"\n  description = \"The amount of memory in megabytes for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"db_disk_allocation\" {\n  default = \"61440\"\n  description = \"The amount of disk space for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"user_username\"{\n  default = \"admin\"\n  description = \"name of the admin user for postgres database\"\n}\n\nvariable \"user_password\" {\n  default = \"password123\"\n  description = \"password for the lab database\"\n}\n```\n\n### MongoDB\n\nFollowing script will create an instance of MongoDB\n\n```hcl file=mongodb.tf\n// main.tf\n#*****************************************************************************\n# IBM Terraform Provider Documentation Block References\n#   IBM Provider:    https://cloud.ibm.com/docs/terraform?topic=terraform-provider-reference&-access-data-sources\n#   Resource Group:  https://cloud.ibm.com/docs/terraform?topic=terraform-resource-management-data-sources&-access-data-sources#resource-group\n#\n#   Database :       https://cloud.ibm.com/docs/terraform?topic=terraform-databases-resources#db\n#   Access Group:    https://cloud.ibm.com/docs/terraform?topic=terraform-iam-resources&-access-data-sources#iam-access-group-policy\n#*****************************************************************************\n\n##############################################################################\n# IBM Cloud Provider\n##############################################################################\n\nprovider \"ibm\" {\n  region             = \"${var.ibm_region}\"\n  generation         = 2\n  ibmcloud_timeout   = 60\n}\n\n##############################################################################\n\n\n\n##############################################################################\n# Resource group ID from name\n##############################################################################\ndata \"ibm_resource_group\" \"group\" {\n  name = \"${var.resource_group_name}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Provision database instance\n##############################################################################\nresource \"ibm_database\" \"db_instance\" {\n  name              = \"${var.db_name}\"\n  plan              = \"${var.plan}\"\n  location          = \"${var.ibm_region}\"\n  service           = \"databases-for-mongodb\"\n  resource_group_id = \"${data.ibm_resource_group.group.id}\"\n\n  adminpassword                = \"${var.db_admin_password}\"\n  members_memory_allocation_mb = \"${var.db_memory_allocation}\"\n  members_disk_allocation_mb   = \"${var.db_disk_allocation}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Grant User Access to Database\n# For simplification, this block is not used. You can assign access policies at the\n# account, resource group, service, instance using this type of block.\n##############################################################################\n# resource \"ibm_iam_access_group_policy\" \"ex2_db_policy\" {\n#  access_group_id = ibm_iam_access_group.labuser.id\n#  roles        = [\"Reader\"]\n\n#  resources = [{\n#    service = \"databases-for-mongodb\"\n#    resource_instance_id = element(split(\":\", ibm_database.db_instance.id),7)\n#  }\n#  ]\n# }\n##############################################################################\n\n// outputs.tf\n\noutput \"db_crn_id\" {\n  value = \"${ibm_database.db_instance.id}\"\n}\n/*\noutput \"db_connection_string\" {\n  value = \"http://${ibm_database.db_instance.connectionstrings.0.name}\"\n} */\n\noutput \"db_admin_userid\" {\n  value = \"${ibm_database.db_instance.adminuser}\"\n}\noutput \"db_version\" {\n  value = \"${ibm_database.db_instance.version}\"\n}\n\n// variables.tf\n\n\n\nvariable \"plan\" {\n  default = \"standard\"\n  description = \"Cloud Database Plan\"\n}\nvariable \"ibm_region\" {\n  default = \"us-south\"\n  description = \"Cloud Database region \"\n}\nvariable \"db_name\" {\n  default = \"ex2_test_db_lab\"\n  description = \"Database name\"\n}\nvariable \"resource_group_name\" {\n  description = \"IBM Cloud Resource Group Name\"\n}\nvariable \"db_admin_password\" {\n  default = \"password123\"\n  description = \"Database administration password\"\n}\n\nvariable \"db_memory_allocation\" {\n  default = \"3072\"\n  description = \"The amount of memory in megabytes for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"db_disk_allocation\" {\n  default = \"61440\"\n  description = \"The amount of disk space for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"user_username\"{\n  default = \"admin\"\n  description = \"name of the admin user for mongodb\"\n}\n\nvariable \"user_password\" {\n  default = \"password123\"\n  description = \"password for the lab database\"\n}\n\n\n```\n\n### MQ\nLearn more about MQ in IBM Cloud by refering to this [documentation]{https://cloud.ibm.com/docs/services/mqcloud}.  \n\nThe script below creates an instance of MQ in your cloud account.\n\n```hcl = mq.tf\nprovider \"ibm\" {\n  generation = 2\n  region     = \"us-south\"\n}\n\ndata \"ibm_resource_group\" \"group\" {\n  name = \"Default\"               // create in the default group\n}\n\nresource \"ibm_resource_instance\" \"resource_instance\" {\n  name              = \"mq-instance-test\"\n  service           = \"mqcloud\"\n  plan              = \"default\" // custom , default or lite\n  location          = \"us-south\"\n  resource_group_id = data.ibm_resource_group.group.id\n  tags              = [\"message queue\", \"testmq\"]\n\n  //User can increase timeouts \n  timeouts {\n    create = \"15m\"\n    update = \"15m\"\n    delete = \"15m\"\n  }\n}\n```\n\n### Demo & Cleanup\n\nFor any of the above scripts,\n\nTo run the script, use\n```bash\nterraform init\nterraform apply\n```\n\nTo cleanup:\n\n```bash\nterraform destroy\n```\n\n\n\n\n\n\n\n","type":"Mdx","contentDigest":"2f6ccd509af0bce152b80ef334e8b664","counter":580,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"IaC to Cloud Services","description":"Use IaC to work with managed Databases services","keywords":"terraform,ibm cloud,db,dba"},"exports":{},"rawBody":"---\ntitle: IaC to Cloud Services\ndescription: Use IaC to work with managed Databases services\nkeywords: 'terraform,ibm cloud,db,dba'\n---\n\n<!--\n\nThe pattern to document the resources is like follow:\n- Introduce the resource with an example\n- List all or the most important input parameters\n- If will be used, list the most important output parameters\n- Provide instructions to get the value of the input parameters, either using `ibmcloud`, API or the Web console.\n- If needed, instructions to execute the code either with Terraform or Schematics\n\n-->\n\n<PageDescription>\n\nUse of IaC to work with Cloud Services such as Managed Databases and  MQ (Message Queue)\n\n</PageDescription>\n\nThis page contains example scripts for some of the following services.  You can directly navigate to the resource you are interested in using the links.\n\nAs you look at the PostgreSQL & MongoDB scripts, you will notice the similarity.  In fact, except for the 'serviceID', they are identical.  This is because the scripts are using Resource Management Resources.  You can find out more about it [here](https://cloud.ibm.com/docs/terraform?topic=terraform-resource-mgmt-resources#resource-instance).  \n\n<AnchorLinks small>\n  <AnchorLink>PostgreSQL</AnchorLink>\n  <AnchorLink>MongoDB</AnchorLink>\n  <AnchorLink>MQ</AnchorLink>\n  <AnchorLink>Demo & Cleanup</AnchorLink>\n</AnchorLinks>\n\nIBM Cloud Database offers many database options, each one being useful in a particular use-case.  You can refer to this [documentation](https://www.ibm.com/cloud/databases) for more information on IBM Cloud Databases.  \n\n### PostgreSQL\n\nFollowing script will create an instance of the PostgreSQL in the resource group you specify.  \n\n```hcl path=postgreSQL.tf\n// main.tf\n#*****************************************************************************\n# IBM Terraform Provider Documentation Block References\n#   IBM Provider:    https://cloud.ibm.com/docs/terraform?topic=terraform-provider-reference&-access-data-sources\n#   Resource Group:  https://cloud.ibm.com/docs/terraform?topic=terraform-resource-management-data-sources&-access-data-sources#resource-group\n#\n#   Database :       https://cloud.ibm.com/docs/terraform?topic=terraform-databases-resources#db\n#   Access Group:    https://cloud.ibm.com/docs/terraform?topic=terraform-iam-resources&-access-data-sources#iam-access-group-policy\n#*****************************************************************************\n\n##############################################################################\n# IBM Cloud Provider\n##############################################################################\n\nprovider \"ibm\" {\n  region             = \"${var.ibm_region}\"\n  generation         = 2\n  ibmcloud_timeout   = 60\n}\n\n##############################################################################\n\n\n\n##############################################################################\n# Resource group ID from name\n##############################################################################\ndata \"ibm_resource_group\" \"group\" {\n  name = \"${var.resource_group_name}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Provision database instance\n##############################################################################\nresource \"ibm_database\" \"db_instance\" {\n  name              = \"${var.db_name}\"\n  plan              = \"${var.plan}\"\n  location          = \"${var.ibm_region}\"\n  service           = \"databases-for-postgresql\"\n  resource_group_id = \"${data.ibm_resource_group.group.id}\"\n\n  adminpassword                = \"${var.db_admin_password}\"\n  members_memory_allocation_mb = \"${var.db_memory_allocation}\"\n  members_disk_allocation_mb   = \"${var.db_disk_allocation}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Grant User Access to Database\n# For simplification, this block is not used. You can assign access policies at the\n# account, resource group, service, instance using this type of block.\n##############################################################################\n# resource \"ibm_iam_access_group_policy\" \"ex2_db_policy\" {\n#  access_group_id = ibm_iam_access_group.labuser.id\n#  roles        = [\"Reader\"]\n\n#  resources = [{\n#    service = \"databases-for-postgresql\"\n#    resource_instance_id = element(split(\":\", ibm_database.db_instance.id),7)\n#  }\n#  ]\n# }\n##############################################################################\n\n// outputs.tf\n\noutput \"db_crn_id\" {\n  value = \"${ibm_database.db_instance.id}\"\n}\n/*\noutput \"db_connection_string\" {\n  value = \"http://${ibm_database.db_instance.connectionstrings.0.name}\"\n} */\n\noutput \"db_admin_userid\" {\n  value = \"${ibm_database.db_instance.adminuser}\"\n}\noutput \"db_version\" {\n  value = \"${ibm_database.db_instance.version}\"\n}\n\n// variables.tf\n\n\n\nvariable \"plan\" {\n  default = \"standard\"\n  description = \"Cloud Database Plan\"\n}\nvariable \"ibm_region\" {\n  default = \"us-south\"\n  description = \"Cloud Database region \"\n}\nvariable \"db_name\" {\n  default = \"ex2_test_db_lab\"\n  description = \"Database name\"\n}\nvariable \"resource_group_name\" {\n  description = \"IBM Cloud Resource Group Name\"\n}\nvariable \"db_admin_password\" {\n  default = \"password123\"\n  description = \"Database administration password\"\n}\n\nvariable \"db_memory_allocation\" {\n  default = \"3072\"\n  description = \"The amount of memory in megabytes for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"db_disk_allocation\" {\n  default = \"61440\"\n  description = \"The amount of disk space for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"user_username\"{\n  default = \"admin\"\n  description = \"name of the admin user for postgres database\"\n}\n\nvariable \"user_password\" {\n  default = \"password123\"\n  description = \"password for the lab database\"\n}\n```\n\n### MongoDB\n\nFollowing script will create an instance of MongoDB\n\n```hcl file=mongodb.tf\n// main.tf\n#*****************************************************************************\n# IBM Terraform Provider Documentation Block References\n#   IBM Provider:    https://cloud.ibm.com/docs/terraform?topic=terraform-provider-reference&-access-data-sources\n#   Resource Group:  https://cloud.ibm.com/docs/terraform?topic=terraform-resource-management-data-sources&-access-data-sources#resource-group\n#\n#   Database :       https://cloud.ibm.com/docs/terraform?topic=terraform-databases-resources#db\n#   Access Group:    https://cloud.ibm.com/docs/terraform?topic=terraform-iam-resources&-access-data-sources#iam-access-group-policy\n#*****************************************************************************\n\n##############################################################################\n# IBM Cloud Provider\n##############################################################################\n\nprovider \"ibm\" {\n  region             = \"${var.ibm_region}\"\n  generation         = 2\n  ibmcloud_timeout   = 60\n}\n\n##############################################################################\n\n\n\n##############################################################################\n# Resource group ID from name\n##############################################################################\ndata \"ibm_resource_group\" \"group\" {\n  name = \"${var.resource_group_name}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Provision database instance\n##############################################################################\nresource \"ibm_database\" \"db_instance\" {\n  name              = \"${var.db_name}\"\n  plan              = \"${var.plan}\"\n  location          = \"${var.ibm_region}\"\n  service           = \"databases-for-mongodb\"\n  resource_group_id = \"${data.ibm_resource_group.group.id}\"\n\n  adminpassword                = \"${var.db_admin_password}\"\n  members_memory_allocation_mb = \"${var.db_memory_allocation}\"\n  members_disk_allocation_mb   = \"${var.db_disk_allocation}\"\n}\n##############################################################################\n\n\n##############################################################################\n# Grant User Access to Database\n# For simplification, this block is not used. You can assign access policies at the\n# account, resource group, service, instance using this type of block.\n##############################################################################\n# resource \"ibm_iam_access_group_policy\" \"ex2_db_policy\" {\n#  access_group_id = ibm_iam_access_group.labuser.id\n#  roles        = [\"Reader\"]\n\n#  resources = [{\n#    service = \"databases-for-mongodb\"\n#    resource_instance_id = element(split(\":\", ibm_database.db_instance.id),7)\n#  }\n#  ]\n# }\n##############################################################################\n\n// outputs.tf\n\noutput \"db_crn_id\" {\n  value = \"${ibm_database.db_instance.id}\"\n}\n/*\noutput \"db_connection_string\" {\n  value = \"http://${ibm_database.db_instance.connectionstrings.0.name}\"\n} */\n\noutput \"db_admin_userid\" {\n  value = \"${ibm_database.db_instance.adminuser}\"\n}\noutput \"db_version\" {\n  value = \"${ibm_database.db_instance.version}\"\n}\n\n// variables.tf\n\n\n\nvariable \"plan\" {\n  default = \"standard\"\n  description = \"Cloud Database Plan\"\n}\nvariable \"ibm_region\" {\n  default = \"us-south\"\n  description = \"Cloud Database region \"\n}\nvariable \"db_name\" {\n  default = \"ex2_test_db_lab\"\n  description = \"Database name\"\n}\nvariable \"resource_group_name\" {\n  description = \"IBM Cloud Resource Group Name\"\n}\nvariable \"db_admin_password\" {\n  default = \"password123\"\n  description = \"Database administration password\"\n}\n\nvariable \"db_memory_allocation\" {\n  default = \"3072\"\n  description = \"The amount of memory in megabytes for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"db_disk_allocation\" {\n  default = \"61440\"\n  description = \"The amount of disk space for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type.\"\n}\n\nvariable \"user_username\"{\n  default = \"admin\"\n  description = \"name of the admin user for mongodb\"\n}\n\nvariable \"user_password\" {\n  default = \"password123\"\n  description = \"password for the lab database\"\n}\n\n\n```\n\n### MQ\nLearn more about MQ in IBM Cloud by refering to this [documentation]{https://cloud.ibm.com/docs/services/mqcloud}.  \n\nThe script below creates an instance of MQ in your cloud account.\n\n```hcl = mq.tf\nprovider \"ibm\" {\n  generation = 2\n  region     = \"us-south\"\n}\n\ndata \"ibm_resource_group\" \"group\" {\n  name = \"Default\"               // create in the default group\n}\n\nresource \"ibm_resource_instance\" \"resource_instance\" {\n  name              = \"mq-instance-test\"\n  service           = \"mqcloud\"\n  plan              = \"default\" // custom , default or lite\n  location          = \"us-south\"\n  resource_group_id = data.ibm_resource_group.group.id\n  tags              = [\"message queue\", \"testmq\"]\n\n  //User can increase timeouts \n  timeouts {\n    create = \"15m\"\n    update = \"15m\"\n    delete = \"15m\"\n  }\n}\n```\n\n### Demo & Cleanup\n\nFor any of the above scripts,\n\nTo run the script, use\n```bash\nterraform init\nterraform apply\n```\n\nTo cleanup:\n\n```bash\nterraform destroy\n```\n\n\n\n\n\n\n\n","fileAbsolutePath":"/Users/johandry/Workspace/ibm/att-cloudnative/ibmcloud-pattern-guide/src/pages/iac-resources/services/index.mdx"}}}}