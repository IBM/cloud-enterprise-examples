{"componentChunkName":"component---src-pages-ci-cd-cloud-native-setup-artifactory-setup-index-mdx","path":"/ci-cd/cloud-native-setup/artifactory-setup/","result":{"pageContext":{"frontmatter":{"title":"Artifactory Setup"},"relativePagePath":"/ci-cd/cloud-native-setup/artifactory-setup/index.mdx","titleType":"page","MdxNode":{"id":"fbf9fa3c-5efe-5a91-852e-1713af8356a3","children":[],"parent":"909fbeda-7872-5a8a-925a-e38ed24a46e5","internal":{"content":"---\ntitle: Artifactory Setup\n---\n\nimport Globals from 'gatsby-theme-carbon/src/templates/Globals';\n\n<PageDescription>\n\nComplete the steps for setting up the Artifactory tool\n\n</PageDescription>\n\n\n<InlineNotification>\n\n**Note**: An **environment administrator** performs the steps on this page. See [Plan Installation > Roles](/admin/plan-installation#roles) for the overview of the roles involved.\n\n</InlineNotification>\n\n\n## Overview\n\nArtifactory is the [<Globals name=\"env\" />'s artifact repository manager](/guides/artifact-management).\nBefore you can use it as part of the [continuous integration pipeline](/guides/continuous-integration),\nit first must be configured as part of the environment.\n\n##  Configuration\n\nSet up Artifactory in the <Globals name=\"env\" /> with a Helm repository.\nAlso, set up the <Globals name=\"env\" /> to access Artifactory.\n\n<InlineNotification kind=\"warning\">\n\n**Warning:** The version of Artifactory that is installed into the cluster is\n not configured for high availability. It is limited to the\n  storage size of your cluster. It is highly recommended you integrate your\n   pipelines with an enterprise grade Helm repository or artifact\n    management\n    system.  \n     \n</InlineNotification>\n\n### Set up Artifactory\n\nCreate a repository in Artifactory for storing Helm charts.\n\n- Open the Artifactory dashboard from the [<Globals name=\"dashboard\" />](/getting-started/dashboard) and login\n\n- Log into Artifactory using the default userid and password, `igc credentials` can show these values. The first time\nyou log in the Welcome Page will prompt you to configure Artifactory using the Onboarding Wizard.\n\n- Press **Get Started**\n\n  <ArtDirection>\n\n  ![Initial JFrog](/images/1-jfrog.png)\n\n  </ArtDirection>\n\n- The first step of the setup wizard is to change the default password. It is\n recommend you use a password generated by a password manager. [1Password\n ](https://1password.com) is the tool IBM recommends to its employees.\n\n  <ArtDirection>\n\n  ![Reset Password](/images/2-resetpassword.png)\n\n  </ArtDirection>\n\n- Save the password somewhere safe or in your password manager; you will need to\n  manually update the password in the  `secret` that is stored in the `tools` namespace/project\n  called `artifactory-access`. There are more detailed instructions after you\n  have completed the setup wizard.\n\nThe next step is to define the base url that will be used by the server. \n\n- From the browser you are currently using copy the `URL` from the address bar.\n\n  <ArtDirection>\n\n  ![Base URL](/images/3-baseurl.png)\n\n  </ArtDirection>\n\n- Past the URL into the **Select Base URL** form and remove any trailing\n context roots, similar to the one in this view.\n\n  <ArtDirection>\n\n  ![Base URL](/images/3-baseurl-complete.png)\n\n  </ArtDirection>\n\n- The next page in the wizard is the Configure a Proxy Server page. This is to\n  setup a proxy for external resources. You can click **Next** to skip this\n  step.\n\n  <ArtDirection>\n\n  ![Base URL](/images/4-proxy.png)\n\n  </ArtDirection>\n\n- The next page in the wizard is the Create Repositories page. Since the open source release of\n  Artifactory doesn't provide a package for Helm repositories, we will use a generic repository to hold the helm\n  artifacts.\n\n- Select **Generic**, then press **Next**\n\n  <ArtDirection>\n\n  ![Select Repo Type](/images/5-selectrepotype.png)\n\n  </ArtDirection>\n\n- The next page in the wizard is the Onboarding Complete page. \n\n- Press **Finish**\n\n  <ArtDirection>\n\n  ![Setup Complete](/images/5-createcomplete.png)\n\n  </ArtDirection>\n\n### Allow Anonymous Access to Artifactory\n\n- Open the Artifactory dashboard from the [<Globals name=\"dashboard\" />](/getting-started/dashboard) and login\n\n- Click on the **Settings** tab on the left menu (the one with the gear icon), and then select\n **Security**\n    ![Security Configuration](/images/securitysettings.png)\n\n- Check the `Allow Anonymous Access` check box and press **Save**\n\n### Obtain the encrypted password \n\nTo enable the CI pipelines ([Jenkins](/guides/continuous-integration), [Tekton](/guides/continuous-integration-tekton), etc.)\nto store the Helm artifacts in the Artifactory repository, we need to obtain\nArtifactory's encrypted password and save it where the pipeline can access the password -- in the `artifactory-access`\nKubernetes secret in the `tools` namespace in the Development Tools environment.\n\n- In the Artifactory console, press the **Welcome, admin** menu button in the top right corner of the console and select **Edit profile**\n\n- In the User Profile: admin page, enter you Artifactory password and press **Unlock**\n\n  <ArtDirection>\n\n  ![API Key](/images/jfrogapikey.png)\n\n  </ArtDirection>\n\nBelow, in the **Authentication Settings** section, is the **Encrypted Password** field.\n\n- Press the **Eye** icon to view the encrypted password and press the **Cut & Paste** icon to copy it\n\n  <ArtDirection>\n\n  ![Initial JFrog](/images/viewapikey.png)\n\n  </ArtDirection>\n\n- Now we have obtained the **Encrypt** key and had kept a copy of the\n  Password we changed on the initial setup wizard. We need to update the\n  secrets that stores these inside the cluster.\n\n### Update the OpenShift secret\n\n- Open the OpenShift 4 Console then select the **Administrator** menu. Select **Workloads\n  ** then **Secrets**. At the top select the `tool` namespace and narrow the selection to\n  `artifactory-access` then select the **Edit Secrets** context menu on the right. You do\n  not need to base encode these values the OpenShift console does this for you.\n  ![Initial JFrog](/images/settingskeys.png)\n\n- Update the values that you retrieved for the encrypt key and updated the\n admin password\n    - Update the `ARTIFACTORY_ENCRYPT` value with your encrypt key value\n    - Update the `ARTIFACTORY_PASSWORD` value with thew new admin password\n \n- Click **Save** in OpenShift Console \n\n- View the secret in the console and confirm that the visible value of `ARTIFACTORY_ENCRPT` matches the encrypted password shown in the Artifactory console\n\n- You can check the values were updated correctly by running `igc credentials` from the command line\n\n### Kubernetes and OpenShift 3\n\nTo update the secret in Kuberentes or Openshift 3 navigate to the `secret` called `artifactory-access`\nin the `tools` namespace and update the following values. You will need encode these value in base64 key before\nediting the secret.\n\n[Kubernetes secrets](https://kubernetes.io/docs/concepts/configuration/secret/#creating-a-secret-manually) \nstore data in base64 format. So to store Artifactory's encrypted password in a secret, it needs to be encoded into\nbase64.\n\nAny base64 encoding tool will work. For example:\n\n- Go to the [Base64 Encode](https://www.base64encode.org/) website\n\n- Paste the encrypted password into the online tool and press the **Encode** button\n\n- In the field below, copy the encoded value into you clipboard or store it somewhere safe\n\n- Find the `ARTIFACTORY_ENCRYPT` value (under `data`) and paste in the Artifactory base64 key into the field\n\n- Find the `ARTIFACTORY_PASSWORD` value (under `data`) and paste in the\n\n## Rerun the Pipeline\n\nPreviously, when you deployed you first app, the pipeline's Package Helm Chart stage didn't store the chart because \nthe `ARTIFACTORY_ENCRYPT` property was not set. Now that it has been set, rerun your pipeline and check that the Helm\nchart for your app is stored correctly in Artifactory with matching semantic version information.\n\n- In the Artifactory console, select the Artifacts page and expand the `generic-local` repository\n\n  <ArtDirection>\n\n  ![Artifact Repository Browser](/images/artifact-repo-browser.png)\n\n  </ArtDirection>\n\nYou will see a folder named after your resource group containing the tar file for a Helm chart.\n\n## Conclusion\n\nArtifactory is now set up in your <Globals name=\"env\" /> and CI pipelines can\n store Helm charts in Artifactory repository. Artifactory can now be used as a\n  Helm repository for CD tools like ArgoCD and IBM Cloud Pak for Multi\n   Cloud\n   Management.\n","type":"Mdx","contentDigest":"105a7fae50c4f768dd4a37fa4cd1e569","counter":639,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Artifactory Setup"},"exports":{},"rawBody":"---\ntitle: Artifactory Setup\n---\n\nimport Globals from 'gatsby-theme-carbon/src/templates/Globals';\n\n<PageDescription>\n\nComplete the steps for setting up the Artifactory tool\n\n</PageDescription>\n\n\n<InlineNotification>\n\n**Note**: An **environment administrator** performs the steps on this page. See [Plan Installation > Roles](/admin/plan-installation#roles) for the overview of the roles involved.\n\n</InlineNotification>\n\n\n## Overview\n\nArtifactory is the [<Globals name=\"env\" />'s artifact repository manager](/guides/artifact-management).\nBefore you can use it as part of the [continuous integration pipeline](/guides/continuous-integration),\nit first must be configured as part of the environment.\n\n##  Configuration\n\nSet up Artifactory in the <Globals name=\"env\" /> with a Helm repository.\nAlso, set up the <Globals name=\"env\" /> to access Artifactory.\n\n<InlineNotification kind=\"warning\">\n\n**Warning:** The version of Artifactory that is installed into the cluster is\n not configured for high availability. It is limited to the\n  storage size of your cluster. It is highly recommended you integrate your\n   pipelines with an enterprise grade Helm repository or artifact\n    management\n    system.  \n     \n</InlineNotification>\n\n### Set up Artifactory\n\nCreate a repository in Artifactory for storing Helm charts.\n\n- Open the Artifactory dashboard from the [<Globals name=\"dashboard\" />](/getting-started/dashboard) and login\n\n- Log into Artifactory using the default userid and password, `igc credentials` can show these values. The first time\nyou log in the Welcome Page will prompt you to configure Artifactory using the Onboarding Wizard.\n\n- Press **Get Started**\n\n  <ArtDirection>\n\n  ![Initial JFrog](/images/1-jfrog.png)\n\n  </ArtDirection>\n\n- The first step of the setup wizard is to change the default password. It is\n recommend you use a password generated by a password manager. [1Password\n ](https://1password.com) is the tool IBM recommends to its employees.\n\n  <ArtDirection>\n\n  ![Reset Password](/images/2-resetpassword.png)\n\n  </ArtDirection>\n\n- Save the password somewhere safe or in your password manager; you will need to\n  manually update the password in the  `secret` that is stored in the `tools` namespace/project\n  called `artifactory-access`. There are more detailed instructions after you\n  have completed the setup wizard.\n\nThe next step is to define the base url that will be used by the server. \n\n- From the browser you are currently using copy the `URL` from the address bar.\n\n  <ArtDirection>\n\n  ![Base URL](/images/3-baseurl.png)\n\n  </ArtDirection>\n\n- Past the URL into the **Select Base URL** form and remove any trailing\n context roots, similar to the one in this view.\n\n  <ArtDirection>\n\n  ![Base URL](/images/3-baseurl-complete.png)\n\n  </ArtDirection>\n\n- The next page in the wizard is the Configure a Proxy Server page. This is to\n  setup a proxy for external resources. You can click **Next** to skip this\n  step.\n\n  <ArtDirection>\n\n  ![Base URL](/images/4-proxy.png)\n\n  </ArtDirection>\n\n- The next page in the wizard is the Create Repositories page. Since the open source release of\n  Artifactory doesn't provide a package for Helm repositories, we will use a generic repository to hold the helm\n  artifacts.\n\n- Select **Generic**, then press **Next**\n\n  <ArtDirection>\n\n  ![Select Repo Type](/images/5-selectrepotype.png)\n\n  </ArtDirection>\n\n- The next page in the wizard is the Onboarding Complete page. \n\n- Press **Finish**\n\n  <ArtDirection>\n\n  ![Setup Complete](/images/5-createcomplete.png)\n\n  </ArtDirection>\n\n### Allow Anonymous Access to Artifactory\n\n- Open the Artifactory dashboard from the [<Globals name=\"dashboard\" />](/getting-started/dashboard) and login\n\n- Click on the **Settings** tab on the left menu (the one with the gear icon), and then select\n **Security**\n    ![Security Configuration](/images/securitysettings.png)\n\n- Check the `Allow Anonymous Access` check box and press **Save**\n\n### Obtain the encrypted password \n\nTo enable the CI pipelines ([Jenkins](/guides/continuous-integration), [Tekton](/guides/continuous-integration-tekton), etc.)\nto store the Helm artifacts in the Artifactory repository, we need to obtain\nArtifactory's encrypted password and save it where the pipeline can access the password -- in the `artifactory-access`\nKubernetes secret in the `tools` namespace in the Development Tools environment.\n\n- In the Artifactory console, press the **Welcome, admin** menu button in the top right corner of the console and select **Edit profile**\n\n- In the User Profile: admin page, enter you Artifactory password and press **Unlock**\n\n  <ArtDirection>\n\n  ![API Key](/images/jfrogapikey.png)\n\n  </ArtDirection>\n\nBelow, in the **Authentication Settings** section, is the **Encrypted Password** field.\n\n- Press the **Eye** icon to view the encrypted password and press the **Cut & Paste** icon to copy it\n\n  <ArtDirection>\n\n  ![Initial JFrog](/images/viewapikey.png)\n\n  </ArtDirection>\n\n- Now we have obtained the **Encrypt** key and had kept a copy of the\n  Password we changed on the initial setup wizard. We need to update the\n  secrets that stores these inside the cluster.\n\n### Update the OpenShift secret\n\n- Open the OpenShift 4 Console then select the **Administrator** menu. Select **Workloads\n  ** then **Secrets**. At the top select the `tool` namespace and narrow the selection to\n  `artifactory-access` then select the **Edit Secrets** context menu on the right. You do\n  not need to base encode these values the OpenShift console does this for you.\n  ![Initial JFrog](/images/settingskeys.png)\n\n- Update the values that you retrieved for the encrypt key and updated the\n admin password\n    - Update the `ARTIFACTORY_ENCRYPT` value with your encrypt key value\n    - Update the `ARTIFACTORY_PASSWORD` value with thew new admin password\n \n- Click **Save** in OpenShift Console \n\n- View the secret in the console and confirm that the visible value of `ARTIFACTORY_ENCRPT` matches the encrypted password shown in the Artifactory console\n\n- You can check the values were updated correctly by running `igc credentials` from the command line\n\n### Kubernetes and OpenShift 3\n\nTo update the secret in Kuberentes or Openshift 3 navigate to the `secret` called `artifactory-access`\nin the `tools` namespace and update the following values. You will need encode these value in base64 key before\nediting the secret.\n\n[Kubernetes secrets](https://kubernetes.io/docs/concepts/configuration/secret/#creating-a-secret-manually) \nstore data in base64 format. So to store Artifactory's encrypted password in a secret, it needs to be encoded into\nbase64.\n\nAny base64 encoding tool will work. For example:\n\n- Go to the [Base64 Encode](https://www.base64encode.org/) website\n\n- Paste the encrypted password into the online tool and press the **Encode** button\n\n- In the field below, copy the encoded value into you clipboard or store it somewhere safe\n\n- Find the `ARTIFACTORY_ENCRYPT` value (under `data`) and paste in the Artifactory base64 key into the field\n\n- Find the `ARTIFACTORY_PASSWORD` value (under `data`) and paste in the\n\n## Rerun the Pipeline\n\nPreviously, when you deployed you first app, the pipeline's Package Helm Chart stage didn't store the chart because \nthe `ARTIFACTORY_ENCRYPT` property was not set. Now that it has been set, rerun your pipeline and check that the Helm\nchart for your app is stored correctly in Artifactory with matching semantic version information.\n\n- In the Artifactory console, select the Artifacts page and expand the `generic-local` repository\n\n  <ArtDirection>\n\n  ![Artifact Repository Browser](/images/artifact-repo-browser.png)\n\n  </ArtDirection>\n\nYou will see a folder named after your resource group containing the tar file for a Helm chart.\n\n## Conclusion\n\nArtifactory is now set up in your <Globals name=\"env\" /> and CI pipelines can\n store Helm charts in Artifactory repository. Artifactory can now be used as a\n  Helm repository for CD tools like ArgoCD and IBM Cloud Pak for Multi\n   Cloud\n   Management.\n","fileAbsolutePath":"/Users/johandry/Workspace/ibm/att-cloudnative/ibmcloud-pattern-guide/src/pages/ci-cd/cloud-native-setup/artifactory-setup/index.mdx"}}}}