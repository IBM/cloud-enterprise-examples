{"componentChunkName":"component---src-pages-logging-configuring-for-containers-index-mdx","path":"/logging/configuring-for-containers/","result":{"pageContext":{"frontmatter":{"title":"Configuring for Containers","description":"VSI, Container and Platform Logging","keywords":"ibm cloud, configuration, policy, procedures"},"relativePagePath":"/logging/configuring-for-containers/index.mdx","titleType":"page","MdxNode":{"id":"934d007f-1ae7-57f1-867b-cedc8652d889","children":[],"parent":"6c355b7e-b0eb-5852-972f-6b0b133b65ce","internal":{"content":"---\ntitle: Configuring for Containers\ndescription: VSI, Container and Platform Logging\nkeywords: 'ibm cloud, configuration, policy, procedures'\n---\n\n<PageDescription>\n\n\nConfiguring for Containers\n\n</PageDescription>\nLogging and Monitoring have always been important but in a distributed microservices architecture on a Kubernetes cluster it is even more important. IBM Cloud with LogDNA can be used with a Kubernetes Cluster. This pattern will show you how to create a Kubenetes cluster and use IBM Cloud with LogDNA for tracking events logs in containers. \n\n<AnchorLinks small>\n  <AnchorLink>Creating a Kubernetes Cluster</AnchorLink>\n  <AnchorLink>Getting the ingestion key</AnchorLink>\n  <AnchorLink>Configuring Kubernetes to Send logs</AnchorLink>\n  <AnchorLink>Deploying the LogDNA agent on Kubernetes</AnchorLink>\n  <AnchorLink>Customizing LogDNA Views</AnchorLink>\n</AnchorLinks>\n\n## Creating a Kubernetes Cluster\n\nFirst create a Kubernetes Cluster using this information, See, \n[Getting Started Kubernetes](https://cloud.ibm.com/docs/containers?topic=containers-getting-started)\n\n\nAfter you create a Kubernetes Cluster, use the IBM Cloud menu->Kubernetes->Cluster, and then select the cluster which you want information for. It will show the dashboard similar to the one below.\n\n![IBM Cloud Kubernetes Deployment](./images/configuredcluster.png \"IBM Cloud Kubernetes\")\n#### Note: Kubernetes event logs can be sent in the same region or in a different region.\n\nYouâ€™ll need to provision an instance of the IBM Log Analysis with LogDNA service. This allows for a configured centralized log management system where log data is hosted on IBM Cloud. You can use either an existing Kubernetes cluster or configure Kubernetes on the IBM Cloud.\nUse an existing or provision a new instance of IBM Log Analysis with LogDNA through the IBM Cloud console, see [Getting Started LogDNA](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-getting-started)\n\nMake sure to choose your supported region, see [Supported Regions](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-regions). \n\n\n## Getting the ingestion key\nFor more information on setting up LogDNA, see [Getting Started](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-getting-started#getting-started_prereqs)\n\nComplete the following steps to get the ingestion key:\n1.\tLog in to your IBM Cloud account  .\nAfter you log in, the IBM Cloud UI opens.\n2.\tClick the Menu icon Observability to access the Observability dashboard.\n3.\tSelect Logging. The IBM Log Analysis with LogDNA dashboard opens. You can see the list of logging instances that are available on IBM Cloud.\n4.\tIdentify the instance for which you want to get the ingestion key, and click View key.\n5.\tA window opens where you can click Show to view the ingestion key.\n\n![Get Ingestion Key](./images/ingestionkey.png \"IBM LogDNA Ingestion Key\")\n\n## Configuring Kubernetes to Send logs\n\nNow, let's configure our Kubernetes cluster to send logs to the IBM LogDNA instance configured earlier. We can configure our Kubernetes cluster to send event log traffic to the us-south region, you'll need to complete the following procedures below.\n\n#### Open a terminal to login into your IBM Cloud account.\n```bash\n$ ibmcloud login -a cloud.ibm.com\n```\n\n#### Set the cluster where you want to configure logging as the context for this session.\n```bash\n$ ibmcloud ks cluster-config cluster_name_or_ID\n```\n<InlineNotification>\n\nNote: Every time you log in to the IBM Cloud Kubernetes Service CLI to work with your cluster, you must run this setup to set the path to the cluster's configuration file as a session variable. IBM Cloud Kubernetes Service uses this variable to find a local configuration file and certificates that are necessary to connect with your cluster.\n\nSee [Getting Started IBM Cloud CLI](https://cloud.ibm.com/docs/cli?topic=cloud-cli-getting-started), and [CLI for Kubernetes](https://cloud.ibm.com/docs/containers?topic=containers-cs_cli_install)\n\n</InlineNotification>\n\n## Deploying the LogDNA agent on Kubernetes\n\n#### Let's now create a Kubernetes secret to store your logDNA ingestion key for your service instance. \n* Note: us-south region is shown below, choose the region according to your requirements. \n\n```bash\n$ kubectl create -f https://assets.us-south.logging.cloud.ibm.com/clients/logdna-agent-ds.yaml\n```\nThe LogDNA ingestion key will be used to open a secure web socket to the logDNA ingestion server and to authenticate the logging agent with the IBM Log Analysis with LogDNA service.\n\n#### Now, let's verify our LogDNA agent was deployed successfully by running the following command. \n```bash\n$ kubectl get pods\n```\n#### If the deployment was successful you should see one or more LogDNA pods running. \n\n<InlineNotification>\n\nNote: You can use the IBM Cloud terminal under Kubernetes cluster and the Action tab to the left to open a terminal.  \n\n</InlineNotification>\n\n![LogDNA Pods](./images/logdnarunning.png \" LogDNA Pods Running\")\n\nYou'll notice the number of LogDNA pods is equal to the number of worker nodes in your cluster. All pods should be in a Running state.\n\nNow let's take a look at the logs captured by IBM Log Analysis with LogDNA, by viewing the dashboard. Launch the LogDNA dashboard and view logs.\nYou can do so by going through the IBM Cloud console, following the steps below:\n\n1. Log in to your IBM Cloud account External link icon.\n\n2. From the Menu icon, select Observability.\n\n3. Select Logging. The list of IBM Log Analysis with LogDNA service instances that are available on IBM Cloud is displayed.\n\n4. Select one instance and click View LogDNA. The LogDNA dashboard opens.\n\n![IBM Cloud Menu](./images/observability.png \"Observability\")\n\n\n\n<InlineNotification> \n\nNote: With the Free service plan, you can tail your latest logs only. For more information, see [Viewing Logs](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-view_logs#view_logs)\n\n</InlineNotification>\n\n## Customizing LogDNA Views\n\nNow let's customize your default view.\nIn the USER PREFERENCES section, you can modify the order of the data fields that are displayed per line.\n\nComplete the following steps to modify the format of a log line:\nSelect the Configuration icon. ![Configuration](./images/configicon.png \"Configuration Icon\")\n\nSelect USER PREFERENCES. A new window opens.\n![User Preference](./images/userpreference.png \"Configure Preference\")\n\n\nChoose something different from the default Viewer Theme, let's select Monokai.\n![Monokai](./images/userpreference2.png \"Select Monokai\")\n\nSelect Log Format, modify the Line Format section to match your requirements.\n![Line Format](./images/lineformat.png \"Format Line\")\n\nLet's look into a log line, at anytime you can view each event log line in context. \nComplete the following steps:\n1. Click the Views icon Configuration icon. ![Configuration](./images/views.png \"Configuration View\")\n2. Select Everything or a view.\n3. Identify a line in the log that you want to explore.\n4. Expand the log line.\n\nInformation about line identifiers, tags, and labels is displayed.\n![Everything](./images/everythingview.png \" Everything View\")\n\nExpanded view of the log line, from step 4 above. \n![Log Line](./images/lineview.png \" Log Line View\")\n\n5. Click View in Context to see the log line in context of other log lines.\n![View Context](./images/viewincontext.png \"View Context\")\n\n6. Click Copy to clipboard to copy the message field to the clipboard. When you are finished, close the line. \n![Clipboard](./images/clipboard.png \"View Context\")\n\nWith IBM Log Analysis with LogDNA, you can filter logs by log source, application and even log level. Sources of event log searches or filters can be a host, computer, virtual machine or Heroku app. Next, let's try out filtering logs.\n\n1. Click on the Views icon\n![Filter Configuration](./images/views.png \"Filters\")\n\n2. Select Everything or a view.\n3. Expand All Tags to see the list of tags that are identified in the logs. Then, choose the ones that you want.\n4. Expand All Sources to see the list of log sources that are identified in the logs. Then, choose the ones that you want.\n5. Expand All Apps to see the list of apps that are identified in the logs. Then, choose the ones that you want.\n6. Expand All Levels to see the list of log levels that are identified in the logs. Then, choose the ones that you want.\n<InlineNotification>\nNote: In each section, you can group multiple options into a group. Group tags, log sources, apps, and log levels to reuse these groupings when you filter log data in other custom views.\n</InlineNotification>\n\nNotice, the All Apps expanded view below.\n![All Apps](./images/expandedapps.png \"Expanded Apps View\")\n\nFor our last activity, lets create a view. Follow the steps below. \n\n1. Click the Views icon Configuration icon. ![View Context](./images/views.png \"Filters\")\n2. Select Everything or a view.\n3. Filter log data then click Save as new view / alert.\n The Create new view page opens.\n\n4. Enter a name for the view in the Name field.\n\n5. Optionally, attach an alert. A new section is displayed for you to configure the alert.\n\n6. Click Save View\n\nShown below is a saved view, notice the error logs displayed.\n![Views](./images/customview.png \"Configure a View\")\n\nYou can manage your Views by Categories.\n\n![Saved View](./images/managingviews.png \"Saved View\")\n\n#### For more information on IBM Cloud Log Analysis with LogDNA, visit [Getting Started](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-getting-started)","type":"Mdx","contentDigest":"5554f58258296a11032ccf4a3e58978c","counter":575,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Configuring for Containers","description":"VSI, Container and Platform Logging","keywords":"ibm cloud, configuration, policy, procedures"},"exports":{},"rawBody":"---\ntitle: Configuring for Containers\ndescription: VSI, Container and Platform Logging\nkeywords: 'ibm cloud, configuration, policy, procedures'\n---\n\n<PageDescription>\n\n\nConfiguring for Containers\n\n</PageDescription>\nLogging and Monitoring have always been important but in a distributed microservices architecture on a Kubernetes cluster it is even more important. IBM Cloud with LogDNA can be used with a Kubernetes Cluster. This pattern will show you how to create a Kubenetes cluster and use IBM Cloud with LogDNA for tracking events logs in containers. \n\n<AnchorLinks small>\n  <AnchorLink>Creating a Kubernetes Cluster</AnchorLink>\n  <AnchorLink>Getting the ingestion key</AnchorLink>\n  <AnchorLink>Configuring Kubernetes to Send logs</AnchorLink>\n  <AnchorLink>Deploying the LogDNA agent on Kubernetes</AnchorLink>\n  <AnchorLink>Customizing LogDNA Views</AnchorLink>\n</AnchorLinks>\n\n## Creating a Kubernetes Cluster\n\nFirst create a Kubernetes Cluster using this information, See, \n[Getting Started Kubernetes](https://cloud.ibm.com/docs/containers?topic=containers-getting-started)\n\n\nAfter you create a Kubernetes Cluster, use the IBM Cloud menu->Kubernetes->Cluster, and then select the cluster which you want information for. It will show the dashboard similar to the one below.\n\n![IBM Cloud Kubernetes Deployment](./images/configuredcluster.png \"IBM Cloud Kubernetes\")\n#### Note: Kubernetes event logs can be sent in the same region or in a different region.\n\nYouâ€™ll need to provision an instance of the IBM Log Analysis with LogDNA service. This allows for a configured centralized log management system where log data is hosted on IBM Cloud. You can use either an existing Kubernetes cluster or configure Kubernetes on the IBM Cloud.\nUse an existing or provision a new instance of IBM Log Analysis with LogDNA through the IBM Cloud console, see [Getting Started LogDNA](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-getting-started)\n\nMake sure to choose your supported region, see [Supported Regions](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-regions). \n\n\n## Getting the ingestion key\nFor more information on setting up LogDNA, see [Getting Started](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-getting-started#getting-started_prereqs)\n\nComplete the following steps to get the ingestion key:\n1.\tLog in to your IBM Cloud account  .\nAfter you log in, the IBM Cloud UI opens.\n2.\tClick the Menu icon Observability to access the Observability dashboard.\n3.\tSelect Logging. The IBM Log Analysis with LogDNA dashboard opens. You can see the list of logging instances that are available on IBM Cloud.\n4.\tIdentify the instance for which you want to get the ingestion key, and click View key.\n5.\tA window opens where you can click Show to view the ingestion key.\n\n![Get Ingestion Key](./images/ingestionkey.png \"IBM LogDNA Ingestion Key\")\n\n## Configuring Kubernetes to Send logs\n\nNow, let's configure our Kubernetes cluster to send logs to the IBM LogDNA instance configured earlier. We can configure our Kubernetes cluster to send event log traffic to the us-south region, you'll need to complete the following procedures below.\n\n#### Open a terminal to login into your IBM Cloud account.\n```bash\n$ ibmcloud login -a cloud.ibm.com\n```\n\n#### Set the cluster where you want to configure logging as the context for this session.\n```bash\n$ ibmcloud ks cluster-config cluster_name_or_ID\n```\n<InlineNotification>\n\nNote: Every time you log in to the IBM Cloud Kubernetes Service CLI to work with your cluster, you must run this setup to set the path to the cluster's configuration file as a session variable. IBM Cloud Kubernetes Service uses this variable to find a local configuration file and certificates that are necessary to connect with your cluster.\n\nSee [Getting Started IBM Cloud CLI](https://cloud.ibm.com/docs/cli?topic=cloud-cli-getting-started), and [CLI for Kubernetes](https://cloud.ibm.com/docs/containers?topic=containers-cs_cli_install)\n\n</InlineNotification>\n\n## Deploying the LogDNA agent on Kubernetes\n\n#### Let's now create a Kubernetes secret to store your logDNA ingestion key for your service instance. \n* Note: us-south region is shown below, choose the region according to your requirements. \n\n```bash\n$ kubectl create -f https://assets.us-south.logging.cloud.ibm.com/clients/logdna-agent-ds.yaml\n```\nThe LogDNA ingestion key will be used to open a secure web socket to the logDNA ingestion server and to authenticate the logging agent with the IBM Log Analysis with LogDNA service.\n\n#### Now, let's verify our LogDNA agent was deployed successfully by running the following command. \n```bash\n$ kubectl get pods\n```\n#### If the deployment was successful you should see one or more LogDNA pods running. \n\n<InlineNotification>\n\nNote: You can use the IBM Cloud terminal under Kubernetes cluster and the Action tab to the left to open a terminal.  \n\n</InlineNotification>\n\n![LogDNA Pods](./images/logdnarunning.png \" LogDNA Pods Running\")\n\nYou'll notice the number of LogDNA pods is equal to the number of worker nodes in your cluster. All pods should be in a Running state.\n\nNow let's take a look at the logs captured by IBM Log Analysis with LogDNA, by viewing the dashboard. Launch the LogDNA dashboard and view logs.\nYou can do so by going through the IBM Cloud console, following the steps below:\n\n1. Log in to your IBM Cloud account External link icon.\n\n2. From the Menu icon, select Observability.\n\n3. Select Logging. The list of IBM Log Analysis with LogDNA service instances that are available on IBM Cloud is displayed.\n\n4. Select one instance and click View LogDNA. The LogDNA dashboard opens.\n\n![IBM Cloud Menu](./images/observability.png \"Observability\")\n\n\n\n<InlineNotification> \n\nNote: With the Free service plan, you can tail your latest logs only. For more information, see [Viewing Logs](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-view_logs#view_logs)\n\n</InlineNotification>\n\n## Customizing LogDNA Views\n\nNow let's customize your default view.\nIn the USER PREFERENCES section, you can modify the order of the data fields that are displayed per line.\n\nComplete the following steps to modify the format of a log line:\nSelect the Configuration icon. ![Configuration](./images/configicon.png \"Configuration Icon\")\n\nSelect USER PREFERENCES. A new window opens.\n![User Preference](./images/userpreference.png \"Configure Preference\")\n\n\nChoose something different from the default Viewer Theme, let's select Monokai.\n![Monokai](./images/userpreference2.png \"Select Monokai\")\n\nSelect Log Format, modify the Line Format section to match your requirements.\n![Line Format](./images/lineformat.png \"Format Line\")\n\nLet's look into a log line, at anytime you can view each event log line in context. \nComplete the following steps:\n1. Click the Views icon Configuration icon. ![Configuration](./images/views.png \"Configuration View\")\n2. Select Everything or a view.\n3. Identify a line in the log that you want to explore.\n4. Expand the log line.\n\nInformation about line identifiers, tags, and labels is displayed.\n![Everything](./images/everythingview.png \" Everything View\")\n\nExpanded view of the log line, from step 4 above. \n![Log Line](./images/lineview.png \" Log Line View\")\n\n5. Click View in Context to see the log line in context of other log lines.\n![View Context](./images/viewincontext.png \"View Context\")\n\n6. Click Copy to clipboard to copy the message field to the clipboard. When you are finished, close the line. \n![Clipboard](./images/clipboard.png \"View Context\")\n\nWith IBM Log Analysis with LogDNA, you can filter logs by log source, application and even log level. Sources of event log searches or filters can be a host, computer, virtual machine or Heroku app. Next, let's try out filtering logs.\n\n1. Click on the Views icon\n![Filter Configuration](./images/views.png \"Filters\")\n\n2. Select Everything or a view.\n3. Expand All Tags to see the list of tags that are identified in the logs. Then, choose the ones that you want.\n4. Expand All Sources to see the list of log sources that are identified in the logs. Then, choose the ones that you want.\n5. Expand All Apps to see the list of apps that are identified in the logs. Then, choose the ones that you want.\n6. Expand All Levels to see the list of log levels that are identified in the logs. Then, choose the ones that you want.\n<InlineNotification>\nNote: In each section, you can group multiple options into a group. Group tags, log sources, apps, and log levels to reuse these groupings when you filter log data in other custom views.\n</InlineNotification>\n\nNotice, the All Apps expanded view below.\n![All Apps](./images/expandedapps.png \"Expanded Apps View\")\n\nFor our last activity, lets create a view. Follow the steps below. \n\n1. Click the Views icon Configuration icon. ![View Context](./images/views.png \"Filters\")\n2. Select Everything or a view.\n3. Filter log data then click Save as new view / alert.\n The Create new view page opens.\n\n4. Enter a name for the view in the Name field.\n\n5. Optionally, attach an alert. A new section is displayed for you to configure the alert.\n\n6. Click Save View\n\nShown below is a saved view, notice the error logs displayed.\n![Views](./images/customview.png \"Configure a View\")\n\nYou can manage your Views by Categories.\n\n![Saved View](./images/managingviews.png \"Saved View\")\n\n#### For more information on IBM Cloud Log Analysis with LogDNA, visit [Getting Started](https://cloud.ibm.com/docs/Log-Analysis-with-LogDNA?topic=LogDNA-getting-started)","fileAbsolutePath":"/Users/johandry/Workspace/ibm/att-cloudnative/ibmcloud-pattern-guide/src/pages/logging/configuring-for-containers/index.mdx"}}}}