{"version":3,"sources":["webpack:///./src/pages/deploy-iks/hpa/index.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"2eAMO,IAAMA,EAAe,GAOtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,2CAA0B,0BAAYC,WAAW,KAAvB,OAA1B,gFAA0J,0BAAYA,WAAW,KAAvB,6BAA1J,KACA,kDACA,oEACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,yEAIL,qGACA,kFAAiE,0BAAYA,WAAW,KAAvB,iBAAjE,+DACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,sBAIL,0DACA,gDAA+B,0BAAYA,WAAW,KAAvB,yBAA/B,gKACA,sBACE,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,UAA8B,0BAAYA,WAAW,KAAvB,qBAA9B,OAAmG,0BAAYA,WAAW,KAAvB,0BAAnG,cACA,mBAAKA,WAAW,MAAK,sBAAMA,WAAW,OAAU,CAC5C,UAAa,kBADI,mKASvB,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,iEACA,mBAAKA,WAAW,MAAK,sBAAMA,WAAW,OAAU,CAC5C,UAAa,kBADI,iDAMzB,qCACA,iFACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,uBAIL,sFACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,yBAIL,iGACA,qJACA,mBAAU,CACR,UAAa,4BACb,MAAS,CACP,SAAY,WACZ,QAAW,QACX,WAAc,OACd,YAAe,OACf,SAAY,UAPhB,WAUI,sBAAMA,WAAW,QAAW,CAC5B,UAAa,qCACb,MAAS,CACP,cAAiB,qBACjB,SAAY,WACZ,OAAU,IACV,KAAQ,IACR,gBAAmB,4fACnB,eAAkB,QAClB,QAAW,YAnBjB,OAsBA,qBAAKA,WAAW,QAAW,CACvB,UAAa,0BACb,IAAO,iBACP,MAAS,iBACT,IAAO,6FACP,OAAU,CAAC,kGAAmG,kGAAmG,mGACjN,MAAS,kCACT,MAAS,CACP,MAAS,OACT,OAAU,OACV,OAAU,IACV,cAAiB,SACjB,SAAY,WACZ,IAAO,IACP,KAAQ,KAEV,QAAW,UAtCf,UAyCA,2EACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,+CAIL,+HACA,mBAAU,CACR,UAAa,4BACb,MAAS,CACP,SAAY,WACZ,QAAW,QACX,WAAc,OACd,YAAe,OACf,SAAY,WAPhB,WAUI,sBAAMA,WAAW,QAAW,CAC5B,UAAa,qCACb,MAAS,CACP,cAAiB,qBACjB,SAAY,WACZ,OAAU,IACV,KAAQ,IACR,gBAAmB,w/BACnB,eAAkB,QAClB,QAAW,YAnBjB,OAsBA,qBAAKA,WAAW,QAAW,CACvB,UAAa,0BACb,IAAO,YACP,MAAS,YACT,IAAO,2FACP,OAAU,CAAC,gGAAiG,gGAAiG,kGAC7M,MAAS,oCACT,MAAS,CACP,MAAS,OACT,OAAU,OACV,OAAU,IACV,cAAiB,SACjB,SAAY,WACZ,IAAO,IACP,KAAQ,KAEV,QAAW,UAtCf,UAyCA,wMACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,+BAQTJ,EAAWK,gBAAiB","file":"component---src-pages-deploy-iks-hpa-index-mdx-61a85e62e95019f123e7.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/johandry/Workspace/ibm/att-cloudnative/ibmcloud-pattern-guide/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <p>{`Before configuring `}<inlineCode parentName=\"p\">{`hpa`}</inlineCode>{`, please make sure you have deployed the application as explained in section `}<inlineCode parentName=\"p\">{`Deploy Application to IKS`}</inlineCode>{`.`}</p>\n    <h2>{`Configure a HPA resource`}</h2>\n    <p>{`Run the following command to configure HPA.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kubectl autoscale deployment test --cpu-percent=25 --min=1 --max=5\n`}</code></pre>\n    <p>{`This HPA scales up when CPU exceeds 25% of the allocated container resource.`}</p>\n    <p>{`You can view the HPA using kubectl. You probably will see `}<inlineCode parentName=\"p\">{`<unknown>/25%`}</inlineCode>{` for 1-2 minutes and then you should be able to see 0%/25%.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kubectl get hpa\n`}</code></pre>\n    <h2>{`Generate load to trigger scaling`}</h2>\n    <p>{`In the code repository, `}<inlineCode parentName=\"p\">{`generate-load-hpa.yml`}</inlineCode>{` is provided, which is used to increase the load on CPU. It creates 10 replicas of a container where each container calls CPU intensive operation in a loop.`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Modify `}<inlineCode parentName=\"p\">{`Ingress subdomain`}</inlineCode>{` in `}<inlineCode parentName=\"p\">{`generate-load-hpa.yaml`}</inlineCode>{` as shown.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`## macOS\n$ sed -i '' s#HOST#<YOUR_INGRESS_SUBDOMAIN># generate-load-hpa.yaml\n\n## Linux\n$ sed -i s#HOST#<YOUR_INGRESS_SUBDOMAIN># generate-load-hpa.yaml\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Run the following command from the terminal to increase load.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`kubectl create -f generate-load-hpa.yaml\n`}</code></pre>\n      </li>\n    </ul>\n    <h2>{`Monitor HPA`}</h2>\n    <p>{`In a terminal, you can check the number of pods created.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kubectl get pods\n`}</code></pre>\n    <p>{`In the another tab, watch the HPA with the following command:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kubectl get hpa -w\n`}</code></pre>\n    <p>{`You will see HPA scale the pods from 1 up to our configured maximum (5).`}</p>\n    <p>{`The resource usage can also be checked through Kubernetes dashboard. Access the dashboard, it will show something like this.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"966px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"23.61111111111111%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABF0lEQVQY01WQu07DQBBF/XOI76GjJz9BAyUVBQ0SFQ0Fj0ikC7EECIGIcRw7tvfhXe/6MI5pGOnq7rzuXG2SZRlVVTHGMAzEIfIvJPV9T1mW5HnOOO+8l1lpxWG/M4Ww7CZKKbquk2akD2FfX6h3zje3XBR35K6GEKmbmk1R4Dojy2G69IfVp+NmbiibnkRrPRkRwch0bfZ9yUF6wuFqxlX5uK9tqxJrDa2FdRnIBEUduH6yHJ81HJ3WvK1F0BiDFrTiVIl4YxTzIuV+s+Rhu+Sj/WEQh7azdCL4+tUwX+54TmuBvF9qFumIHa32JNZaRpcj2rbFaEO0nqAd0Qh3Huccvfyjl79zVtM7he+UsCZ4vecx997xC4DbetuHK7mPAAAAAElFTkSuQmCC')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"ResourceStatus\",\n        \"title\": \"ResourceStatus\",\n        \"src\": \"/cloud-enterprise-examples/static/13c992ddcffa596a71bb8b56bdc54347/d65e0/cpu-mem-usage.png\",\n        \"srcSet\": [\"/cloud-enterprise-examples/static/13c992ddcffa596a71bb8b56bdc54347/7fc1e/cpu-mem-usage.png 288w\", \"/cloud-enterprise-examples/static/13c992ddcffa596a71bb8b56bdc54347/a5df1/cpu-mem-usage.png 576w\", \"/cloud-enterprise-examples/static/13c992ddcffa596a71bb8b56bdc54347/d65e0/cpu-mem-usage.png 966w\"],\n        \"sizes\": \"(max-width: 966px) 100vw, 966px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`You can now stop load using the following command.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kubectl delete deployment load-generator\n`}</code></pre>\n    <p>{`You will notice that HPA will slowly bring the replica count to min number based on its configuration.`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1030px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"96.18055555555557%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAClElEQVQ4y42UC3OaQBSF+f8/rNNOjBmT+EJ8gLGJ1Sgi+AD19n4XlpBp0ykzjCzufnvuOXfxJpOJrFYrmc/nEgSBLJdLSdNU9vu9TKdTWSwWsl6v7b/xeGy/vV5Pwk5bgh/fJGx9l/T1ReIkkSLPxZvNZhLHsU1+fn6WKIoMejwebcyGh8PBNj2dThLvdrJ7f5dTOJZ4s5H07afki1D88UTWOscDBJBd2+22DAYD6ff7kuiO3W7XxlmWyeVyEa5ElcvtKtdfr5LlhchV329W0tV58XYrnu/7stGdnp6epNVqGQQ4QMadTsfKRx3XVje/Fblc3l4kUeVyPslt9SZ9fySXohAPn1A4HA4Nygaj0ciAj4+PphaFufrDtdP3ogsB7jIF5mcDTtUq5niEwWLMpjw2wFdUoZQNAJ7P54+SL0Wl8FgDZ9G8DCUMQ9mp0SxEEZ5yA2TsgE6hAU3h4hNwGkYlkAVbNZNE7+7uTBVlsgkh8R64U0jKruQ4zWrgQG3KdY5HqQAJAwAwbiAEgsq/AQsDpjXQ16pyffboO9S4hqVceo/mdp4C+6eH66UEOs8UulBIFmUAuAEyjqr0XNs0PdxXwKsqnGgW5qFrbBZTMu2Dr6imjUj8EzDZ1x4mjbYJJtOPUGhsvCIUvOQGeH9/b3DK5Si6xjYP9fxu92ml8FV6Q7/0sNnYQPmlfEp2Z7mp8KOxteTjqVY4qubVHlK6C+F/PLwuF5Kd89pDTkpRVI0NkNLwDEXNlPn/q1DSSmEZyheN3fw40Ie0E0DnYbOx7eNQAf1gXALxywEJwZ0UgA8PD+bnn8C8PHoo1GdCGen30ICusfEQEOXiIeeXkiPzprCkb7dbGYo29lWBB50jh9RCcX34G9zDjEJmaODZAAAAAElFTkSuQmCC')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"HPAStatus\",\n        \"title\": \"HPAStatus\",\n        \"src\": \"/cloud-enterprise-examples/static/6bd6cba5b07d850bb4ff18a81d327f1b/c987a/kubectl-hpa.png\",\n        \"srcSet\": [\"/cloud-enterprise-examples/static/6bd6cba5b07d850bb4ff18a81d327f1b/7fc1e/kubectl-hpa.png 288w\", \"/cloud-enterprise-examples/static/6bd6cba5b07d850bb4ff18a81d327f1b/a5df1/kubectl-hpa.png 576w\", \"/cloud-enterprise-examples/static/6bd6cba5b07d850bb4ff18a81d327f1b/c987a/kubectl-hpa.png 1030w\"],\n        \"sizes\": \"(max-width: 1030px) 100vw, 1030px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`Once the replica count reaches to 1, it means it has scaled-down properly after decreasing load on CPU. Then we can clean-up the hpa configuration using the following command.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kubectl delete hpa test\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}