{"componentChunkName":"component---src-pages-deploy-vsi-setup-environment-index-mdx","path":"/deploy-vsi/setup-environment/","result":{"pageContext":{"frontmatter":{"title":"Set up VSI on VPC(Gen 2) and configure auto-scale","description":"Overview of Deploying an application on a VS and cause auto-scaling of VSI","keywords":"ibm cloud"},"relativePagePath":"/deploy-vsi/setup-environment/index.mdx","titleType":"page","MdxNode":{"id":"35255479-df80-58b8-a68a-1acbd9c1f9a1","children":[],"parent":"da651b0f-a2f6-5422-bcec-3cc4c2cda74d","internal":{"content":"---\ntitle: Set up VSI on VPC(Gen 2) and configure auto-scale \ndescription: Overview of Deploying an application on a VS and cause auto-scaling of VSI\nkeywords: 'ibm cloud'\n---\n### Test architecture\n\nFor our auto scale test, we will create one instance of VPC and configure autoscale on it. The minimum number of virtual server instance will be one. A WAS Liberty server with a J2EE application  will be deployed on the Virtual Server through a user data script that we will specify in the auto scale instance template configuration.\n\n![Test Architecture](./images/test_architecture.png \"Test architecture\")   \n\n### Create an instance of Virtual Private Cloud\n\nClick [here](https://cloud.ibm.com/vpc-ext/provision/vpc) to create an instance of VPC from the catalog.\n\nConfigure as shown below. Please make sure you specify `Name` for VPC,`Name` for subnet and enable `Public gateway`. Click `Create Virtual Private Cloud` to create a VPC instance.\n\n![CreateVPC](./images/create_vpc.png \"Create VPC\")   \n\n\n### Create an Instance template\n\nSelect `Instance templates` in the menu.\n\n![InstanceTemplate](./images/select_create_instance_template.png \"Select create instance template\")   \n\nSelect `New instance template`.\n\n![SelectNewTemplate](./images/select_new_instance_template.png \"Select new instance template\") \n\nPlease configure as shown below. Please ensure that you specify `Name` for instance, `Virtual Private Cloud` we created earlier, `Location`(Dallas), `Image`(Ubuntu),`Profile`(4 vCPU, 4GB RAM, 4Gbps), `SSH keys`(Create one if not done before) and `User data`(please see next image for specifying user script).\n\n![CreateInstanceTemplate](./images/create_instance_template.png \"Create instance template\") \n\n\nEnter user data for application deployment. \n\n![Enter user script](./images/enter_user_script.png \"Enter user script\") \n\n```\n#!/bin/sh\nwget https://raw.githubusercontent.com/IBM/cloud-enterprise-examples/master/artifacts/auto-scale/vsi-vpc/scripts/install-script\nchmod +x install-script\n./install-script\n```\n\nClick `Create instance template`.\n\n### Create an Instance group\n\nSelect `Instance groups` from the menu.\n\n![Select instance group](./images/select_create_instance_group.png \"Select instance group\") \n\nClick on `New instance group`. Configure the instance group as shown below. Please make sure you specify `Name` for group, `Virtual Private Cloud` we created earlier, `Location`,`subnet` we specified during VPC creation, `Select instance template` we created earlier, `Choose Scaling method`(Select method as Dynamic),`Set instance group size`(Minimum:1, Maximum:3,Aggregation Window:90, Cooldown period(120) and `Create scaling policies`. We have set the target utilization in the scaling policy as 20%. \n\nClick `Create instance group`.\n\n![Create instance group](./images/create_instance_group.png \"Create instance group\") \n\n\n### Test application \n\nView the created VSI on the console:\n\n![View VSI](./images/view_vsi.png \"View VSI\") \n\nReserve IP:\n\n![Reserve IP](./images/reserve_floating_ip.png \"Reserve IP\") \n\nCopy IP:\n![Copy IP](./images/copy_ip.png \"Copy IP\") \n\nInvoke the below endpoint to test deployment\n```\nhttp://[IP address]:9080/autoscale-webapp/HelloWorldServlet\n```\nThis endpoint returns \"Hello World\" string. This can be used to test if the application deployed successfully.\n\n","type":"Mdx","contentDigest":"d6f3a77a27f74702aae83325bf21ddfa","counter":710,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Set up VSI on VPC(Gen 2) and configure auto-scale","description":"Overview of Deploying an application on a VS and cause auto-scaling of VSI","keywords":"ibm cloud"},"exports":{},"rawBody":"---\ntitle: Set up VSI on VPC(Gen 2) and configure auto-scale \ndescription: Overview of Deploying an application on a VS and cause auto-scaling of VSI\nkeywords: 'ibm cloud'\n---\n### Test architecture\n\nFor our auto scale test, we will create one instance of VPC and configure autoscale on it. The minimum number of virtual server instance will be one. A WAS Liberty server with a J2EE application  will be deployed on the Virtual Server through a user data script that we will specify in the auto scale instance template configuration.\n\n![Test Architecture](./images/test_architecture.png \"Test architecture\")   \n\n### Create an instance of Virtual Private Cloud\n\nClick [here](https://cloud.ibm.com/vpc-ext/provision/vpc) to create an instance of VPC from the catalog.\n\nConfigure as shown below. Please make sure you specify `Name` for VPC,`Name` for subnet and enable `Public gateway`. Click `Create Virtual Private Cloud` to create a VPC instance.\n\n![CreateVPC](./images/create_vpc.png \"Create VPC\")   \n\n\n### Create an Instance template\n\nSelect `Instance templates` in the menu.\n\n![InstanceTemplate](./images/select_create_instance_template.png \"Select create instance template\")   \n\nSelect `New instance template`.\n\n![SelectNewTemplate](./images/select_new_instance_template.png \"Select new instance template\") \n\nPlease configure as shown below. Please ensure that you specify `Name` for instance, `Virtual Private Cloud` we created earlier, `Location`(Dallas), `Image`(Ubuntu),`Profile`(4 vCPU, 4GB RAM, 4Gbps), `SSH keys`(Create one if not done before) and `User data`(please see next image for specifying user script).\n\n![CreateInstanceTemplate](./images/create_instance_template.png \"Create instance template\") \n\n\nEnter user data for application deployment. \n\n![Enter user script](./images/enter_user_script.png \"Enter user script\") \n\n```\n#!/bin/sh\nwget https://raw.githubusercontent.com/IBM/cloud-enterprise-examples/master/artifacts/auto-scale/vsi-vpc/scripts/install-script\nchmod +x install-script\n./install-script\n```\n\nClick `Create instance template`.\n\n### Create an Instance group\n\nSelect `Instance groups` from the menu.\n\n![Select instance group](./images/select_create_instance_group.png \"Select instance group\") \n\nClick on `New instance group`. Configure the instance group as shown below. Please make sure you specify `Name` for group, `Virtual Private Cloud` we created earlier, `Location`,`subnet` we specified during VPC creation, `Select instance template` we created earlier, `Choose Scaling method`(Select method as Dynamic),`Set instance group size`(Minimum:1, Maximum:3,Aggregation Window:90, Cooldown period(120) and `Create scaling policies`. We have set the target utilization in the scaling policy as 20%. \n\nClick `Create instance group`.\n\n![Create instance group](./images/create_instance_group.png \"Create instance group\") \n\n\n### Test application \n\nView the created VSI on the console:\n\n![View VSI](./images/view_vsi.png \"View VSI\") \n\nReserve IP:\n\n![Reserve IP](./images/reserve_floating_ip.png \"Reserve IP\") \n\nCopy IP:\n![Copy IP](./images/copy_ip.png \"Copy IP\") \n\nInvoke the below endpoint to test deployment\n```\nhttp://[IP address]:9080/autoscale-webapp/HelloWorldServlet\n```\nThis endpoint returns \"Hello World\" string. This can be used to test if the application deployed successfully.\n\n","fileAbsolutePath":"/Users/johandry/Workspace/ibm/att-cloudnative/ibmcloud-pattern-guide/src/pages/deploy-vsi/setup-environment/index.mdx"}}}}