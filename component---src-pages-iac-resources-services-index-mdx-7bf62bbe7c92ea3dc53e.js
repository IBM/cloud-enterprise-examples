(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{CyJs:function(e,n,a){"use strict";a.r(n),a.d(n,"_frontmatter",(function(){return s})),a.d(n,"default",(function(){return m}));a("91GP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("q1tI");var r=a("7ljp"),o=a("013z");a("qKvR");function t(){return(t=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var s={},i=function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(r.b)("div",n)}},c=i("PageDescription"),u=i("AnchorLinks"),d=i("AnchorLink"),b={_frontmatter:s},l=o.a;function m(e){var n=e.components,a=function(e,n){if(null==e)return{};var a,r,o={},t=Object.keys(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,["components"]);return Object(r.b)(l,t({},b,a,{components:n,mdxType:"MDXLayout"}),Object(r.b)(c,{mdxType:"PageDescription"},Object(r.b)("p",null,"Use of IaC to work with Cloud Services such as Managed Databases and  MQ (Message Queue)")),Object(r.b)("p",null,"This page contains example scripts for some of the following services.  You can directly navigate to the resource you are interested in using the links."),Object(r.b)("p",null,"As you look at the PostgreSQL & MongoDB scripts, you will notice the similarity.  In fact, except for the ‘serviceID’, they are identical.  This is because the scripts are using Resource Management Resources.  You can find out more about it ",Object(r.b)("a",t({parentName:"p"},{href:"https://cloud.ibm.com/docs/terraform?topic=terraform-resource-mgmt-resources#resource-instance"}),"here"),".  "),Object(r.b)(u,{small:!0,mdxType:"AnchorLinks"},Object(r.b)(d,{mdxType:"AnchorLink"},"PostgreSQL"),Object(r.b)(d,{mdxType:"AnchorLink"},"MongoDB"),Object(r.b)(d,{mdxType:"AnchorLink"},"MQ"),Object(r.b)(d,{mdxType:"AnchorLink"},"Demo & Cleanup")),Object(r.b)("p",null,"IBM Cloud Database offers many database options, each one being useful in a particular use-case.  You can refer to this ",Object(r.b)("a",t({parentName:"p"},{href:"https://www.ibm.com/cloud/databases"}),"documentation")," for more information on IBM Cloud Databases.  "),Object(r.b)("h3",null,"PostgreSQL"),Object(r.b)("p",null,"Following script will create an instance of the PostgreSQL in the resource group you specify.  "),Object(r.b)("pre",null,Object(r.b)("code",t({parentName:"pre"},{className:"language-hcl",metastring:"path=postgreSQL.tf",path:"postgreSQL.tf"}),'// main.tf\n#*****************************************************************************\n# IBM Terraform Provider Documentation Block References\n#   IBM Provider:    https://cloud.ibm.com/docs/terraform?topic=terraform-provider-reference&-access-data-sources\n#   Resource Group:  https://cloud.ibm.com/docs/terraform?topic=terraform-resource-management-data-sources&-access-data-sources#resource-group\n#\n#   Database :       https://cloud.ibm.com/docs/terraform?topic=terraform-databases-resources#db\n#   Access Group:    https://cloud.ibm.com/docs/terraform?topic=terraform-iam-resources&-access-data-sources#iam-access-group-policy\n#*****************************************************************************\n\n##############################################################################\n# IBM Cloud Provider\n##############################################################################\n\nprovider "ibm" {\n  region             = "${var.ibm_region}"\n  generation         = 2\n  ibmcloud_timeout   = 60\n}\n\n##############################################################################\n\n\n\n##############################################################################\n# Resource group ID from name\n##############################################################################\ndata "ibm_resource_group" "group" {\n  name = "${var.resource_group_name}"\n}\n##############################################################################\n\n\n##############################################################################\n# Provision database instance\n##############################################################################\nresource "ibm_database" "db_instance" {\n  name              = "${var.db_name}"\n  plan              = "${var.plan}"\n  location          = "${var.ibm_region}"\n  service           = "databases-for-postgresql"\n  resource_group_id = "${data.ibm_resource_group.group.id}"\n\n  adminpassword                = "${var.db_admin_password}"\n  members_memory_allocation_mb = "${var.db_memory_allocation}"\n  members_disk_allocation_mb   = "${var.db_disk_allocation}"\n}\n##############################################################################\n\n\n##############################################################################\n# Grant User Access to Database\n# For simplification, this block is not used. You can assign access policies at the\n# account, resource group, service, instance using this type of block.\n##############################################################################\n# resource "ibm_iam_access_group_policy" "ex2_db_policy" {\n#  access_group_id = ibm_iam_access_group.labuser.id\n#  roles        = ["Reader"]\n\n#  resources = [{\n#    service = "databases-for-postgresql"\n#    resource_instance_id = element(split(":", ibm_database.db_instance.id),7)\n#  }\n#  ]\n# }\n##############################################################################\n\n// outputs.tf\n\noutput "db_crn_id" {\n  value = "${ibm_database.db_instance.id}"\n}\n/*\noutput "db_connection_string" {\n  value = "http://${ibm_database.db_instance.connectionstrings.0.name}"\n} */\n\noutput "db_admin_userid" {\n  value = "${ibm_database.db_instance.adminuser}"\n}\noutput "db_version" {\n  value = "${ibm_database.db_instance.version}"\n}\n\n// variables.tf\n\n\n\nvariable "plan" {\n  default = "standard"\n  description = "Cloud Database Plan"\n}\nvariable "ibm_region" {\n  default = "us-south"\n  description = "Cloud Database region "\n}\nvariable "db_name" {\n  default = "ex2_test_db_lab"\n  description = "Database name"\n}\nvariable "resource_group_name" {\n  description = "IBM Cloud Resource Group Name"\n}\nvariable "db_admin_password" {\n  default = "password123"\n  description = "Database administration password"\n}\n\nvariable "db_memory_allocation" {\n  default = "3072"\n  description = "The amount of memory in megabytes for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type."\n}\n\nvariable "db_disk_allocation" {\n  default = "61440"\n  description = "The amount of disk space for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type."\n}\n\nvariable "user_username"{\n  default = "admin"\n  description = "name of the admin user for postgres database"\n}\n\nvariable "user_password" {\n  default = "password123"\n  description = "password for the lab database"\n}\n')),Object(r.b)("h3",null,"MongoDB"),Object(r.b)("p",null,"Following script will create an instance of MongoDB"),Object(r.b)("pre",null,Object(r.b)("code",t({parentName:"pre"},{className:"language-hcl",metastring:"file=mongodb.tf",file:"mongodb.tf"}),'// main.tf\n#*****************************************************************************\n# IBM Terraform Provider Documentation Block References\n#   IBM Provider:    https://cloud.ibm.com/docs/terraform?topic=terraform-provider-reference&-access-data-sources\n#   Resource Group:  https://cloud.ibm.com/docs/terraform?topic=terraform-resource-management-data-sources&-access-data-sources#resource-group\n#\n#   Database :       https://cloud.ibm.com/docs/terraform?topic=terraform-databases-resources#db\n#   Access Group:    https://cloud.ibm.com/docs/terraform?topic=terraform-iam-resources&-access-data-sources#iam-access-group-policy\n#*****************************************************************************\n\n##############################################################################\n# IBM Cloud Provider\n##############################################################################\n\nprovider "ibm" {\n  region             = "${var.ibm_region}"\n  generation         = 2\n  ibmcloud_timeout   = 60\n}\n\n##############################################################################\n\n\n\n##############################################################################\n# Resource group ID from name\n##############################################################################\ndata "ibm_resource_group" "group" {\n  name = "${var.resource_group_name}"\n}\n##############################################################################\n\n\n##############################################################################\n# Provision database instance\n##############################################################################\nresource "ibm_database" "db_instance" {\n  name              = "${var.db_name}"\n  plan              = "${var.plan}"\n  location          = "${var.ibm_region}"\n  service           = "databases-for-mongodb"\n  resource_group_id = "${data.ibm_resource_group.group.id}"\n\n  adminpassword                = "${var.db_admin_password}"\n  members_memory_allocation_mb = "${var.db_memory_allocation}"\n  members_disk_allocation_mb   = "${var.db_disk_allocation}"\n}\n##############################################################################\n\n\n##############################################################################\n# Grant User Access to Database\n# For simplification, this block is not used. You can assign access policies at the\n# account, resource group, service, instance using this type of block.\n##############################################################################\n# resource "ibm_iam_access_group_policy" "ex2_db_policy" {\n#  access_group_id = ibm_iam_access_group.labuser.id\n#  roles        = ["Reader"]\n\n#  resources = [{\n#    service = "databases-for-mongodb"\n#    resource_instance_id = element(split(":", ibm_database.db_instance.id),7)\n#  }\n#  ]\n# }\n##############################################################################\n\n// outputs.tf\n\noutput "db_crn_id" {\n  value = "${ibm_database.db_instance.id}"\n}\n/*\noutput "db_connection_string" {\n  value = "http://${ibm_database.db_instance.connectionstrings.0.name}"\n} */\n\noutput "db_admin_userid" {\n  value = "${ibm_database.db_instance.adminuser}"\n}\noutput "db_version" {\n  value = "${ibm_database.db_instance.version}"\n}\n\n// variables.tf\n\n\n\nvariable "plan" {\n  default = "standard"\n  description = "Cloud Database Plan"\n}\nvariable "ibm_region" {\n  default = "us-south"\n  description = "Cloud Database region "\n}\nvariable "db_name" {\n  default = "ex2_test_db_lab"\n  description = "Database name"\n}\nvariable "resource_group_name" {\n  description = "IBM Cloud Resource Group Name"\n}\nvariable "db_admin_password" {\n  default = "password123"\n  description = "Database administration password"\n}\n\nvariable "db_memory_allocation" {\n  default = "3072"\n  description = "The amount of memory in megabytes for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type."\n}\n\nvariable "db_disk_allocation" {\n  default = "61440"\n  description = "The amount of disk space for the database, split across all members. If not specified, the default setting of the database service is used, which can vary by database type."\n}\n\nvariable "user_username"{\n  default = "admin"\n  description = "name of the admin user for mongodb"\n}\n\nvariable "user_password" {\n  default = "password123"\n  description = "password for the lab database"\n}\n\n\n')),Object(r.b)("h3",null,"MQ"),Object(r.b)("p",null,"Learn more about MQ in IBM Cloud by refering to this ","[documentation]","{",Object(r.b)("a",t({parentName:"p"},{href:"https://cloud.ibm.com/docs/services/mqcloud%7D"}),"https://cloud.ibm.com/docs/services/mqcloud}"),".  "),Object(r.b)("p",null,"The script below creates an instance of MQ in your cloud account."),Object(r.b)("pre",null,Object(r.b)("code",t({parentName:"pre"},{className:"language-hcl",metastring:"= mq.tf","":"","mq.tf":!0}),'provider "ibm" {\n  generation = 2\n  region     = "us-south"\n}\n\ndata "ibm_resource_group" "group" {\n  name = "Default"               // create in the default group\n}\n\nresource "ibm_resource_instance" "resource_instance" {\n  name              = "mq-instance-test"\n  service           = "mqcloud"\n  plan              = "default" // custom , default or lite\n  location          = "us-south"\n  resource_group_id = data.ibm_resource_group.group.id\n  tags              = ["message queue", "testmq"]\n\n  //User can increase timeouts \n  timeouts {\n    create = "15m"\n    update = "15m"\n    delete = "15m"\n  }\n}\n')),Object(r.b)("h3",null,"Demo & Cleanup"),Object(r.b)("p",null,"For any of the above scripts,"),Object(r.b)("p",null,"To run the script, use"),Object(r.b)("pre",null,Object(r.b)("code",t({parentName:"pre"},{className:"language-bash"}),"terraform init\nterraform apply\n")),Object(r.b)("p",null,"To cleanup:"),Object(r.b)("pre",null,Object(r.b)("code",t({parentName:"pre"},{className:"language-bash"}),"terraform destroy\n")))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-iac-resources-services-index-mdx-7bf62bbe7c92ea3dc53e.js.map